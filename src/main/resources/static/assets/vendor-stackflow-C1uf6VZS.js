import{a as e,t}from"./rolldown-runtime-DDUpfMIz.js";import{i as n,r}from"./vendor-react-Bqg-xpfE.js";function i(e){var t,n,r=``;if(typeof e==`string`||typeof e==`number`)r+=e;else if(typeof e==`object`)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=i(e[t]))&&(r&&(r+=` `),r+=n)}else for(n in e)e[n]&&(r&&(r+=` `),r+=n);return r}function a(){for(var e,t,n=0,r=``,a=arguments.length;n<a;n++)(e=arguments[n])&&(t=i(e))&&(r&&(r+=` `),r+=t);return r}var o=a;function s(e){var t=e.match(/^var\((.*)\)$/);return t?t[1]:e}function c(e,t){var n=e;for(var r of t){if(!(r in n))throw Error(`Path ${t.join(` -> `)} does not exist in object`);n=n[r]}return n}function l(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r={};for(var i in e){var a=e[i],o=[...n,i];typeof a==`string`||typeof a==`number`||a==null?r[i]=t(a,o):typeof a==`object`&&!Array.isArray(a)?r[i]=l(a,t,o):console.warn(`Skipping invalid key "${o.join(`.`)}". Should be a string, number, null or object. Received: "${Array.isArray(a)?`Array`:typeof a}"`)}return r}function u(e,t){var n={};if(typeof t==`object`){var r=e;l(t,(e,t)=>{if(e!=null){var i=c(r,t);n[s(i)]=String(e)}})}else{var i=e;for(var a in i){var o=i[a];o!=null&&(n[s(a)]=o)}}return Object.defineProperty(n,`toString`,{value:function(){return Object.keys(this).map(e=>`${e}:${this[e]}`).join(`;`)},writable:!1}),n}function d(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function f(e){var t=d(e,`string`);return typeof t==`symbol`?t:String(t)}function p(e,t,n){return t=f(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?m(Object(n),!0).forEach(function(t){p(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t){var n={};for(var r in e)n[r]=t(e[r],r);return n}var _=(e,t,n)=>{for(var r of Object.keys(e))if(e[r]!==(t[r]??n[r]))return!1;return!0},v=e=>{var t=t=>{var n=e.defaultClassName,r=h(h({},e.defaultVariants),t);for(var i in r){var a=r[i]??e.defaultVariants[i];if(a!=null){var o=a;typeof o==`boolean`&&(o=o===!0?`true`:`false`);var s=e.variantClassNames[i][o];s&&(n+=` `+s)}}for(var[c,l]of e.compoundVariants)_(c,r,e.defaultVariants)&&(n+=` `+l);return n};return t.variants=()=>Object.keys(e.variantClassNames),t.classNames={get base(){return e.defaultClassName.split(` `)[0]},get variants(){return g(e.variantClassNames,e=>g(e,e=>e.split(` `)[0]))}},t};function y(){return typeof window>`u`}function b(){return!y()}function x(){let e={value:null};function t(){return e.value}function n(t){e.value=t}return[t,n]}var S=t(((e,t)=>{var n=typeof Element<`u`,r=typeof Map==`function`,i=typeof Set==`function`,a=typeof ArrayBuffer==`function`&&!!ArrayBuffer.isView;function o(e,t){if(e===t)return!0;if(e&&t&&typeof e==`object`&&typeof t==`object`){if(e.constructor!==t.constructor)return!1;var s,c,l;if(Array.isArray(e)){if(s=e.length,s!=t.length)return!1;for(c=s;c--!==0;)if(!o(e[c],t[c]))return!1;return!0}var u;if(r&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(u=e.entries();!(c=u.next()).done;)if(!t.has(c.value[0]))return!1;for(u=e.entries();!(c=u.next()).done;)if(!o(c.value[1],t.get(c.value[0])))return!1;return!0}if(i&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(u=e.entries();!(c=u.next()).done;)if(!t.has(c.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(s=e.length,s!=t.length)return!1;for(c=s;c--!==0;)if(e[c]!==t[c])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf==`function`&&typeof t.valueOf==`function`)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString==`function`&&typeof t.toString==`function`)return e.toString()===t.toString();if(l=Object.keys(e),s=l.length,s!==Object.keys(t).length)return!1;for(c=s;c--!==0;)if(!Object.prototype.hasOwnProperty.call(t,l[c]))return!1;if(n&&e instanceof Element)return!1;for(c=s;c--!==0;)if(!((l[c]===`_owner`||l[c]===`__v`||l[c]===`__o`)&&e.$$typeof)&&!o(e[l[c]],t[l[c]]))return!1;return!0}return e!==e&&t!==t}t.exports=function(e,t){try{return o(e,t)}catch(e){if((e.message||``).match(/stack|recursion/i))return console.warn(`react-fast-compare cannot handle circular refs`),!1;throw e}}})),C=e(n(),1),ee=e(S(),1);function w(e){let t=(0,C.useRef)(e),n=t.current,r=(0,ee.default)(n,e);return(0,C.useEffect)(()=>{r||(t.current=e)},[e]),r?n:e}var T=e(r(),1),E=(0,C.createContext)(null),D=({children:e,value:t})=>(0,T.jsx)(E.Provider,{value:w(t),children:e});D.displayName=`ActivityProvider`;var te=()=>(0,C.useContext)(E),O=(0,C.createContext)(null),k=({children:e,value:t})=>(0,T.jsx)(O.Provider,{value:w(t),children:e});k.displayName=`StackProvider`;var A=()=>(0,C.useContext)(O),ne=e(S(),1),re=e(S(),1),ie=Object.defineProperty,ae=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,se=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,N=(e,t,n)=>t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||={})se.call(t,n)&&N(e,n,t[n]);if(j)for(var n of j(t))M.call(t,n)&&N(e,n,t[n]);return e},F=(e,t)=>ae(e,oe(t)),ce=(e,t)=>{var n={};for(var r in e)se.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&j)for(var r of j(e))t.indexOf(r)<0&&M.call(e,r)&&(n[r]=e[r]);return n};function le(e,t,n){let r=n(e),i=n(t);return r<i?-1:r===i?0:1}var ue=(e,t)=>{let n=[],r=[];return e.forEach(e=>{t(e)?n.push(e):r.push(e)}),[n,r]};function de(e,t){return e.map((e,n)=>t(e)?n:void 0).filter(e=>typeof e==`number`)}var fe=0,pe=0,me=()=>{let e=new Date().getTime();return pe===e?fe+=1:(pe=e,fe=0),(e*1e3+fe)/1e3};function I(){return(me()*1e3).toString(16)}function he(e){return e.length===0?void 0:e[e.length-1]}function ge(e,t){let n=P({},e);return t.forEach(e=>{delete n[e]}),n}function _e(e){let t=!1;return()=>{t||(t=!0,e())}}function ve(e,t){let n=new Map;return[...e].reverse().filter(e=>{let r=t(e);if(r===null)return!0;let i=!!n.get(r);return n.set(r,!0),!i}).reverse()}function ye(e){return!e.exitedBy}function be(e,t){return t.enteredBy.eventDate-e.enteredBy.eventDate}function xe(e){return e.filter(ye).sort(be)[0]}function Se(e,t,n){let r=[];switch(t.name){case`Replaced`:{if(he(de(e,e=>e.id===t.activityId))!==void 0)break;let r=e.slice().sort(be).filter(ye),i=n.now-t.eventDate>=n.transitionDuration;if((t.skipEnterActiveState||i?`enter-done`:`enter-active`)==`enter-done`){let n=r.findIndex(e=>!(t.skipEnterActiveState&&e.enteredBy.name===`Replaced`&&e.transitionState===`enter-active`));return r.slice(0,n+1).map(t=>e.indexOf(t))}break}case`Popped`:{let t=e.filter(ye).sort(be),n=t.slice(0,t.length-1)[0];n&&r.push(e.indexOf(n));break}case`StepPushed`:case`StepReplaced`:{let n=xe(e);if(n){if(t.targetActivityId&&t.targetActivityId!==n.id)break;r.push(e.indexOf(n))}break}case`StepPopped`:{let n=xe(e);if(n&&n.steps.length>1){if(t.targetActivityId&&t.targetActivityId!==n.id)break;r.push(e.indexOf(n))}break}default:break}return r}function Ce(e,t){switch(t.name){case`Pushed`:case`Replaced`:return he(de(e,e=>e.id===t.activityId))??e.length;default:return-1}}function we(e,t){return{id:e.activityId,name:e.activityName,transitionState:t,params:e.activityParams,context:e.activityContext,steps:[{id:e.activityId,params:e.activityParams,enteredBy:e,zIndex:-1}],enteredBy:e,isTop:!1,isActive:!1,isRoot:!1,zIndex:-1}}function Te(e){return(t,n)=>{let r=e[n.name].bind(e);if(r)return r(t,n);throw Error(`No reducer for event ${JSON.stringify(n)}`)}}function L(e){return e}function Ee({transitionDuration:e,now:t,resumedAt:n}){return Te({Pushed(r,i){let a=t-(n??i.eventDate)>=e,o=i.skipEnterActiveState||a?`enter-done`:`enter-active`,s=Ce(r,i);return[...r.slice(0,s),we(i,o),...r.slice(s+1)]},Replaced(r,i){let a=t-(n??i.eventDate)>=e,o=Ce(r,i),s=r[o]?.transitionState??(i.skipEnterActiveState||a?`enter-done`:`enter-active`);return[...r.slice(0,o),we(i,s),...r.slice(o+1)]},Initialized:L,ActivityRegistered:L,Popped:L,StepPushed:L,StepReplaced:L,StepPopped:L,Paused:L,Resumed:L})}function De(e){return e}function Oe(e){return Te({Replaced:(e,t)=>F(P({},e),{exitedBy:t,transitionState:`exit-done`}),Popped:(t,n)=>{let r=e.now-(e.resumedAt??n.eventDate)>=e.transitionDuration,i=n.skipExitActiveState||r?`exit-done`:`exit-active`;return F(P({},t),{exitedBy:n,transitionState:i,params:i===`exit-done`?t.steps[0].params:t.params,steps:i===`exit-done`?[t.steps[0]]:t.steps})},StepPushed:(e,t)=>{let n={id:t.stepId,params:t.stepParams,enteredBy:t,zIndex:e.zIndex,hasZIndex:t.hasZIndex??!1};return F(P({},e),{params:t.stepParams,steps:[...e.steps,n]})},StepReplaced:(e,t)=>{let n={id:t.stepId,params:t.stepParams,enteredBy:t,zIndex:e.zIndex,hasZIndex:t.hasZIndex??!1};return F(P({},e),{params:t.stepParams,steps:[...e.steps.slice(0,e.steps.length-1),n]})},StepPopped:(e,t)=>{e.steps.pop();let n=he(e.steps)?.params;return F(P({},e),{params:n??e.params})},Initialized:De,ActivityRegistered:De,Pushed:De,Paused:De,Resumed:De})}function R(e){return(t,n)=>t.globalTransitionState===`paused`?F(P({},t),{pausedEvents:t.pausedEvents?[...t.pausedEvents,n]:[n]}):e(t,n)}function z(e,t){return(n,r)=>{let i=Ee({transitionDuration:n.transitionDuration,now:t.now,resumedAt:t.resumedAt}),a=Oe({transitionDuration:n.transitionDuration,now:t.now,resumedAt:t.resumedAt}),o=i(n.activities,r),s=Se(n.activities,r,{transitionDuration:n.transitionDuration,now:t.now});for(let e of s)o[e]=a(o[e],r);let c=o.find(e=>e.transitionState===`enter-active`||e.transitionState===`exit-active`),l=n.globalTransitionState===`paused`?`paused`:c?`loading`:`idle`;return e(F(P({},n),{activities:o,globalTransitionState:l}),r)}}function ke(e,t){return F(P({},e),{events:[...e.events,t]})}function Ae(e){return Te({Initialized:R(z((e,t)=>F(P({},e),{transitionDuration:t.transitionDuration,events:[...e.events,t]}),e)),ActivityRegistered:R(z((e,t)=>F(P({},e),{registeredActivities:[...e.registeredActivities,P({name:t.activityName},t.activityParamsSchema?{paramsSchema:t.activityParamsSchema}:null)],events:[...e.events,t]}),e)),Paused:R(z((e,t)=>F(P({},e),{globalTransitionState:`paused`,events:[...e.events,t]}),e)),Resumed:z((t,n)=>{if(t.globalTransitionState!==`paused`||!t.pausedEvents)return F(P({},t),{events:[...t.events,n]});let r=Ae({now:e.now,resumedAt:n.eventDate}),i=t,{pausedEvents:a}=i,o=ce(i,[`pausedEvents`]),s=a.reduce(r,F(P({},o),{globalTransitionState:`idle`}));return F(P({},s),{events:[...s.events,n]})},e),Pushed:R(z(ke,e)),Replaced:R(z(ke,e)),Popped:R(z(ke,e)),StepPushed:R(z(ke,e)),StepReplaced:R(z(ke,e)),StepPopped:R(z(ke,e))})}function je(e,t){return e.filter(e=>e.name===t)}function Me(e,t){return F(P({id:I(),eventDate:me()},t),{name:e})}function Ne(e){if(e.length===0)throw Error(`events parameter is empty`);if(je(e,`Initialized`).length>1)throw Error(`InitializedEvent can only exist once`);let t=je(e,`ActivityRegistered`),n=new Set(t.map(e=>e.activityName));if(je(e,`Pushed`).some(e=>!n.has(e.activityName)))throw Error(`the corresponding activity does not exist`)}function Pe(e,t){let n=ve([...e].sort((e,t)=>e.eventDate-t.eventDate),e=>e.id);Ne(n);let r=Ae({now:t}),i=n.reduce(r,{activities:[],globalTransitionState:`idle`,registeredActivities:[],transitionDuration:0,events:[]}),a=i.activities.filter(e=>e.transitionState===`enter-active`||e.transitionState===`enter-done`||e.transitionState===`exit-active`),o=a.filter(e=>e.transitionState===`enter-active`||e.transitionState===`enter-done`),s=a[a.length-1],c=o[o.length-1];return F(P({},i),{activities:i.activities.map(e=>{let t=a.findIndex(({id:t})=>t===e.id),n=a.slice(0,t);for(let e of n)for(let n of e.steps)n.hasZIndex&&(t+=1);let r=e.steps.reduce((e,n)=>{let r=he(e)?.zIndex??t;return[...e,F(P({},n),{zIndex:r+(n.hasZIndex?1:0)})]},[]);return P(P({id:e.id,name:e.name,transitionState:e.transitionState,params:e.params,steps:r,enteredBy:e.enteredBy,zIndex:t,isTop:s?.id===e.id,isActive:c?.id===e.id,isRoot:t===0||t===1&&e.transitionState===`enter-active`&&e.enteredBy.name===`Replaced`},e.exitedBy?{exitedBy:e.exitedBy}:null),e.context?{context:e.context}:null)}).sort((e,t)=>le(e,t,e=>e.id))})}function Fe(e,t){let n=[];(0,re.default)(e,t)||n.push({_TAG:`%SOMETHING_CHANGED%`});let r=e.globalTransitionState!==`paused`&&t.globalTransitionState===`paused`,i=e.globalTransitionState===`paused`&&t.globalTransitionState!==`paused`;r&&n.push({_TAG:`PAUSED`}),i&&n.push({_TAG:`RESUMED`});for(let r=0;r<Math.max(e.activities.length,t.activities.length);r+=1){let i=e.activities[r],a=t.activities[r],o=i?.transitionState===`exit-done`||i?.transitionState===`exit-active`,s=a?.transitionState===`enter-active`||a?.transitionState===`enter-done`;if(i&&a&&i.id===a.id)for(let e=0;e<Math.max((i.steps??[]).length,(a.steps??[]).length);e+=1){let t=i.steps[e],r=a.steps[e];!t&&r?n.push({_TAG:`STEP_PUSHED`,activity:a,step:r}):t&&!r?n.push({_TAG:`STEP_POPPED`,activity:a}):i.steps.length===a.steps.length&&t.id!==r.id&&n.push({_TAG:`STEP_REPLACED`,activity:a,step:r})}!i&&a||o&&s?n.push({_TAG:a.enteredBy.name===`Pushed`?`PUSHED`:`REPLACED`,activity:a}):i&&a&&i.id===a.id&&!(0,re.default)(ge(i,[`isActive`,`isTop`,`isRoot`,`transitionState`,`zIndex`]),ge(a,[`isActive`,`isTop`,`isRoot`,`transitionState`,`zIndex`]))&&a.enteredBy.name===`Replaced`&&!(0,re.default)(i.enteredBy,a.enteredBy)&&n.push({_TAG:`REPLACED`,activity:a})}for(let r=Math.max(e.activities.length,t.activities.length)-1;r>=0;--r){let i=e.activities[r]?.transitionState===`enter-done`||e.activities[r]?.transitionState===`enter-active`,a=t.activities[r]?.transitionState===`exit-active`||t.activities[r]?.transitionState===`exit-done`,o=t.activities[r+1]?.enteredBy.name===`Replaced`&&t.activities[r+1]?.transitionState===`enter-done`;i&&a&&!o&&n.push({_TAG:`POPPED`,activity:t.activities[r]})}return n}var Ie={Pushed:`onBeforePush`,Replaced:`onBeforeReplace`,Popped:`onBeforePop`,StepPushed:`onBeforeStepPush`,StepReplaced:`onBeforeStepReplace`,StepPopped:`onBeforeStepPop`,Paused:`onBeforePause`,Resumed:`onBeforeResume`};function B(e,t,n,r){let i=!1,a=P({},t);for(let t of n){let n=t[Ie[e]];n&&n({actionParams:P({},a),actions:F(P({},r),{preventDefault:()=>{i=!0},overrideActionParams:e=>{a=P(P({},a),e)}})})}return{isPrevented:i,nextActionParams:a}}function Le({dispatchEvent:e,pluginInstances:t,actions:n}){return{push(r){let{isPrevented:i,nextActionParams:a}=B(`Pushed`,r,t,n);i||e(`Pushed`,a)},replace(r){let{isPrevented:i,nextActionParams:a}=B(`Replaced`,r,t,n);i||e(`Replaced`,a)},pop(r={}){let{isPrevented:i,nextActionParams:a}=B(`Popped`,r,t,n);i||e(`Popped`,a)},stepPush(r){let{isPrevented:i,nextActionParams:a}=B(`StepPushed`,r,t,n);i||e(`StepPushed`,a)},stepReplace(r){let{isPrevented:i,nextActionParams:a}=B(`StepReplaced`,r,t,n);i||e(`StepReplaced`,a)},stepPop(r={}){let{isPrevented:i,nextActionParams:a}=B(`StepPopped`,r,t,n);i||e(`StepPopped`,a)},pause(r={}){let{isPrevented:i,nextActionParams:a}=B(`Paused`,r,t,n);i||e(`Paused`,a)},resume(r={}){let{isPrevented:i,nextActionParams:a}=B(`Resumed`,r,t,n);i||e(`Resumed`,a)}}}function Re(e,t,n){e.forEach(e=>{t.forEach(t=>{var r,i,a,o,s,c,l,u,d;switch(e._TAG){case`PUSHED`:(r=t.onPushed)==null||r.call(t,{actions:n,effect:e});break;case`REPLACED`:(i=t.onReplaced)==null||i.call(t,{actions:n,effect:e});break;case`POPPED`:(a=t.onPopped)==null||a.call(t,{actions:n,effect:e});break;case`STEP_PUSHED`:(o=t.onStepPushed)==null||o.call(t,{actions:n,effect:e});break;case`STEP_REPLACED`:(s=t.onStepReplaced)==null||s.call(t,{actions:n,effect:e});break;case`STEP_POPPED`:(c=t.onStepPopped)==null||c.call(t,{actions:n,effect:e});break;case`PAUSED`:(l=t.onPaused)==null||l.call(t,{actions:n,effect:e});break;case`RESUMED`:(u=t.onResumed)==null||u.call(t,{actions:n,effect:e});break;case`%SOMETHING_CHANGED%`:(d=t.onChanged)==null||d.call(t,{actions:n,effect:e});break}})})}var ze=1e3/60;function Be(e){var t,n,r,i;let a=[],o=[(()=>({key:`@stackflow/core`,onChanged(){a.forEach(e=>e())}}))(),...e.plugins.map(e=>e())],[s,c]=ue(e.initialEvents,e=>e.name===`Pushed`||e.name===`StepPushed`),l=o.reduce((t,n)=>n.overrideInitialEvents?.call(n,{initialEvents:t,initialContext:e.initialContext??{}})??t,s);l.length>0&&s.length>0&&l!==s&&((n=(t=e.handlers)?.onInitialActivityIgnored)==null||n.call(t,l)),l.length===0&&((i=(r=e.handlers)?.onInitialActivityNotFound)==null||i.call(r));let u={value:[...c,...l]},d={value:Pe(u.value,new Date().getTime())},f={getStack(){return d.value},dispatchEvent(e,t){let n=Me(e,t),r=Pe([...u.value,n],new Date().getTime());u.value.push(n),p(r);let i=setInterval(()=>{let e=Pe(u.value,new Date().getTime());(0,ne.default)(d.value,e)||p(e),e.globalTransitionState===`idle`&&clearInterval(i)},ze)},push:()=>{},replace:()=>{},pop:()=>{},stepPush:()=>{},stepReplace:()=>{},stepPop:()=>{},pause:()=>{},resume:()=>{}},p=e=>{let t=Fe(d.value,e);d.value=e,Re(t,o,f)};return Object.assign(f,Le({dispatchEvent:f.dispatchEvent,pluginInstances:o,actions:f})),{actions:f,init:_e(()=>{o.forEach(e=>{var t;(t=e.onInit)==null||t.call(e,{actions:f})})}),pullEvents:()=>u.value,subscribe(e){return a.push(e),function(){let t=a.findIndex(t=>t===e);t>-1&&a.splice(t,1)}},pluginInstances:o}}var Ve=(0,C.createContext)(null);function He(){let e=(0,C.useContext)(Ve);if(e===null)throw Error(`useActivityComponentMap must be used within ActivityComponentMapProvider`);return e}function Ue({children:e,value:t}){return(0,T.jsx)(Ve.Provider,{value:t,children:e})}var We=e=>t=>t.find(({id:t})=>t===e);function Ge(e){return!e.exitedBy}function Ke(e,t){return t.enteredBy.eventDate-e.enteredBy.eventDate}function qe(e){return e.filter(Ge).sort(Ke)[0]}function V(){return I()}function Je(){return I()}var Ye=C.useDeferredValue??(e=>e),Xe=C.useSyncExternalStore??((e,t)=>{let[n,r]=(0,C.useState)(()=>t());return(0,C.useEffect)(()=>e(()=>{r(()=>t())})),n}),Ze=C.useTransition??(()=>[!1,e=>e()]),Qe=(0,C.createContext)(null),$e=(0,C.createContext)(null),et=({coreStore:e,children:t})=>{let n=Ye(Xe(e.subscribe,e.actions.getStack,e.actions.getStack));return(0,T.jsx)($e.Provider,{value:n,children:(0,T.jsx)(Qe.Provider,{value:e.actions,children:t})})};et.displayName=`CoreProvider`;var tt=()=>(0,C.useContext)(Qe),nt=()=>(0,C.useContext)($e),rt=(0,C.createContext)(null),it=({children:e,value:t})=>(0,T.jsx)(rt.Provider,{value:t,children:e});it.displayName=`PluginsProvider`;function at(){return(0,C.useContext)(rt)}function ot(e){return typeof e==`object`&&!!e&&`then`in e&&typeof e.then==`function`}var H={PENDING:`pending`,FULFILLED:`fulfilled`,REJECTED:`rejected`};function st(e){if(e.status===H.PENDING)return{status:H.PENDING};if(e.status===H.FULFILLED&&`value`in e)return{status:H.FULFILLED,value:e.value};if(e.status===H.REJECTED&&`reason`in e)return{status:H.REJECTED,reason:e.reason};throw Error(`Invalid promise state`)}function ct(e){if(`status`in e&&Object.values(H).some(t=>t===e.status))return e;let t=Object.assign(e,{status:H.PENDING});return t.then(e=>{t.status=H.FULFILLED,t.value=e},e=>{t.status=H.REJECTED,t.reason=e}),t}function lt(e){return ot(e)?ct(e instanceof Promise?e:Promise.resolve(e)):Object.assign(Promise.resolve(e),{status:H.FULFILLED,value:e})}function ut(e){return Object.assign(Promise.reject(e),{status:H.REJECTED,reason:e})}function dt(e){let t=lt(e),n=st(t);if(n.status===H.FULFILLED)return n.value;throw n.status===H.REJECTED?n.reason:t}var ft=Object.defineProperty,pt=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable,gt=(e,t,n)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_t=(e,t)=>{for(var n in t||={})mt.call(t,n)&&gt(e,n,t[n]);if(pt)for(var n of pt(t))ht.call(t,n)&&gt(e,n,t[n]);return e};function vt(e){let t=null,n=()=>((!t||st(t).status===H.REJECTED)&&(t=e()),t);return{Component:e=>{let{default:t}=dt(n());return(0,T.jsx)(t,_t({},e))},preload:()=>{let e=n();return st(e).status===H.FULFILLED?lt(void 0):e.then(()=>void 0)}}}var yt=Symbol(`STRUCTURED_ACTIVITY_COMPONENT_TYPE`);function bt(e){return typeof e==`object`&&!!e&&yt in e}var xt=new WeakMap;function St(e){if(xt.has(e))return xt.get(e);let{Component:t,preload:n}=vt(()=>{let t=e.content,n=lt(typeof t==`function`?t():{default:t}),r=st(n);return r.status===H.FULFILLED?lt({default:r.value.default.component}):r.status===H.REJECTED?ut(r.reason):lt(n.then(e=>({default:e.default.component})))});return xt.set(e,{Component:t,preload:n}),{Component:t,preload:n}}var Ct=Object.defineProperty,wt=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,Et=Object.getOwnPropertySymbols,Dt=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable,kt=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,U=(e,t)=>{for(var n in t||={})Dt.call(t,n)&&kt(e,n,t[n]);if(Et)for(var n of Et(t))Ot.call(t,n)&&kt(e,n,t[n]);return e},At=(e,t)=>wt(e,Tt(t)),jt=(e,t,n)=>kt(e,typeof t==`symbol`?t:t+``,n),Mt=({plugin:e,initialContext:t})=>{let n=He(),r=nt(),i=at();return e.render({stack:At(U({},r),{render(e){return{activities:U(U({},r),e).activities.map(e=>At(U({},e),{key:e.id,render(r){let a=n[e.name],o=bt(a)?Pt(a,e.params):(0,T.jsx)(a,{params:e.params});return i.forEach(n=>{o=n.wrapActivity?.call(n,{activity:At(U({},e),{render:()=>o}),initialContext:t})??o}),(0,T.jsx)(D,{value:U(U({},e),r),children:o},e.id)}}))}}}),initialContext:t})};Mt.displayName=`PluginRenderer`;var Nt=Mt;function Pt(e,t){let{layout:n,loading:r,errorHandler:i}=e,{Component:a}=St(e);return[e=>r?.component?(0,T.jsx)(C.Suspense,{fallback:(0,T.jsx)(r.component,{params:t}),children:e}):e,e=>i?(0,T.jsx)(i.boundary??Ft,{renderFallback:(e,n)=>(0,T.jsx)(i.component,{params:t,error:e,reset:n}),children:e}):e,e=>n?.component?(0,T.jsx)(n.component,{params:t,children:e}):e].reduce((e,t)=>t(e),(0,T.jsx)(a,{params:t}))}var Ft=class extends C.Component{constructor(){super(...arguments),jt(this,`state`,{hasError:!1,error:null}),jt(this,`reset`,()=>this.setState({hasError:!1,error:null}))}render(){return this.state.hasError?this.props.renderFallback(this.state.error,this.reset):this.props.children}static getDerivedStateFromError(e){return{hasError:!0,error:e}}},It=Object.defineProperty,Lt=Object.defineProperties,Rt=Object.getOwnPropertyDescriptors,zt=Object.getOwnPropertySymbols,Bt=Object.prototype.hasOwnProperty,Vt=Object.prototype.propertyIsEnumerable,Ht=(e,t,n)=>t in e?It(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ut=(e,t)=>{for(var n in t||={})Bt.call(t,n)&&Ht(e,n,t[n]);if(zt)for(var n of zt(t))Vt.call(t,n)&&Ht(e,n,t[n]);return e},Wt=(e,t)=>Lt(e,Rt(t)),Gt=({initialContext:e})=>{let t=nt(),n=at(),r=n.filter(e=>!!e.render);(0,C.useEffect)(()=>{r.length===0&&console.warn(`Stackflow - There is no rendering plugin, so "<Stack />" doesn't render anything. If you want to render some UI, use "@stackflow/plugin-renderer-basic" or add another rendering plugin.`)},[r]);let i=(0,T.jsx)(T.Fragment,{children:r.map(t=>(0,T.jsx)(Nt,{plugin:t,initialContext:e},t.key))});return n.forEach(n=>{i=n.wrapStack?.call(n,{stack:Wt(Ut({},t),{render(){return i}}),initialContext:e})??i}),(0,T.jsx)(k,{value:t,children:i})};Gt.displayName=`MainRenderer`;var Kt=Gt,qt=Object.defineProperty,Jt=Object.getOwnPropertySymbols,Yt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,Zt=(e,t,n)=>t in e?qt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qt=(e,t)=>{for(var n in t||={})Yt.call(t,n)&&Zt(e,n,t[n]);if(Jt)for(var n of Jt(t))Xt.call(t,n)&&Zt(e,n,t[n]);return e};function $t(e){return!e||e.animate==null?{skipActiveState:!1}:{skipActiveState:!e.animate}}function en(){let e=tt(),[t]=Ze();return(0,C.useMemo)(()=>({pending:t,push(t,n,r){let i=V();return e?.push({activityId:i,activityName:t,activityParams:n,skipEnterActiveState:$t(r).skipActiveState}),{activityId:i}},replace(t,n,r){let i=V();return e?.replace({activityId:r?.activityId??V(),activityName:t,activityParams:n,skipEnterActiveState:$t(r).skipActiveState}),{activityId:i}},pop(t,n){let r=1,i={};typeof t==`object`&&(i=Qt({},t)),typeof t==`number`&&(r=t),n&&(i=Qt({},n));for(let t=0;t<r;t+=1)e?.pop({skipExitActiveState:t===0?$t(i).skipActiveState:!0})}}),[e?.push,e?.replace,e?.pop,t])}var tn=()=>{let e=tt(),[t]=Ze();return(0,C.useMemo)(()=>({pending:t,stepPush(t,n){let r=e?.getStack().activities,i=n?.targetActivityId?We(n.targetActivityId):qe,a=r&&i(r);if(!a)throw Error(`The target activity is not found.`);let o=typeof t==`function`?t(a.params):t,s=Je();e?.stepPush({stepId:s,stepParams:o,targetActivityId:n?.targetActivityId})},stepReplace(t,n){let r=e?.getStack().activities,i=n?.targetActivityId?We(n.targetActivityId):qe,a=r&&i(r);if(!a)throw Error(`The target activity is not found.`);let o=typeof t==`function`?t(a.params):t,s=Je();e?.stepReplace({stepId:s,stepParams:o,targetActivityId:n?.targetActivityId})},stepPop(t){e?.stepPop({targetActivityId:t?.targetActivityId})}}),[e?.stepPush,e?.stepReplace,e?.stepPop,e?.getStack,t])},nn=Object.defineProperty,rn=Object.defineProperties,an=Object.getOwnPropertyDescriptors,on=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,cn=Object.prototype.propertyIsEnumerable,ln=(e,t,n)=>t in e?nn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,un=(e,t)=>{for(var n in t||={})sn.call(t,n)&&ln(e,n,t[n]);if(on)for(var n of on(t))cn.call(t,n)&&ln(e,n,t[n]);return e},dn=(e,t)=>rn(e,an(t));function fn(e){return!e||e.animate==null?{skipActiveState:!1}:{skipActiveState:!e.animate}}function pn(e){let t=(e.plugins??[]).flat(1/0).map(e=>e),n=Object.entries(e.activities).reduce((e,[t,n])=>dn(un({},e),{[t]:`component`in n?n.component:n}),{}),r=()=>new Date().getTime()-e.transitionDuration*2,i=Be({initialEvents:[Me(`Initialized`,{transitionDuration:e.transitionDuration,eventDate:r()}),...Object.entries(e.activities).map(([e,t])=>Me(`ActivityRegistered`,un({activityName:e,eventDate:r()},`component`in t?{activityParamsSchema:t.paramsSchema}:null)))],plugins:[]}),[a,o]=x(),s=(0,C.memo)(s=>{let c=(0,C.useMemo)(()=>{let n=a();if(b()&&n)return n;let c=e.initialActivity?[Me(`Pushed`,{activityId:V(),activityName:e.initialActivity(),activityParams:{},eventDate:r(),skipEnterActiveState:!1})]:[],l=Be({initialEvents:[...i.pullEvents(),...c],initialContext:s.initialContext,plugins:t,handlers:{onInitialActivityIgnored:e=>{b()&&console.warn(`Stackflow - Some plugin overrides an "initialActivity" option. The "initialActivity" option you set to "${e[0].activityName}" in the "stackflow" is ignored.`)},onInitialActivityNotFound:()=>{b()&&console.warn("Stackflow - There is no initial activity. If you want to set the initial activity, add the `initialActivity` option of the `stackflow()` function or add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)")}}});return b()&&(l.init(),o(l)),l},[]);return(0,T.jsx)(it,{value:c.pluginInstances,children:(0,T.jsx)(et,{coreStore:c,children:(0,T.jsx)(Ue,{value:n,children:(0,T.jsx)(Kt,{initialContext:s.initialContext})})})})});return s.displayName=`Stack`,{activities:e.activities,Stack:s,useFlow:en,useStepFlow:tn,addActivity(e){if(a()){console.warn("Stackflow - `addActivity()` API cannot be called after a `<Stack />` component has been rendered");return}n[e.name]=(0,C.memo)(e.component),i.actions.dispatchEvent(`ActivityRegistered`,{activityName:e.name,activityParamsSchema:e.paramsSchema,eventDate:r()})},addPlugin(e){if(a()){console.warn("Stackflow - `addPlugin()` API cannot be called after a `<Stack />` component has been rendered");return}[e].flat(1/0).map(e=>e).forEach(e=>{t.push(e)})},actions:{getStack(){return a()?.actions.getStack()??i.actions.getStack()},dispatchEvent(e,t){return a()?.actions.dispatchEvent(e,t)},push(e,t,n){var r;let i=V();return(r=a())==null||r.actions.push({activityId:i,activityName:e,activityParams:t,skipEnterActiveState:fn(n).skipActiveState}),{activityId:i}},replace(e,t,n){var r;let i=n?.activityId??V();return(r=a())==null||r.actions.replace({activityId:n?.activityId??V(),activityName:e,activityParams:t,skipEnterActiveState:fn(n).skipActiveState}),{activityId:i}},pop(e,t){var n;let r=1,i={};typeof e==`object`&&(i=un({},e)),typeof e==`number`&&(r=e),t&&(i=un({},t));for(let e=0;e<r;e+=1)(n=a())==null||n.actions.pop({skipExitActiveState:e===0?fn(i).skipActiveState:!0})},stepPush(e,t){let n=a()?.actions.getStack().activities,r=t?.targetActivityId?We(t.targetActivityId):qe,i=n&&r(n);if(!i)throw Error(`The target activity is not found.`);let o=typeof e==`function`?e(i.params):e,s=Je();return a()?.actions.stepPush({stepId:s,stepParams:o,targetActivityId:t?.targetActivityId})},stepReplace(e,t){let n=a()?.actions.getStack().activities,r=t?.targetActivityId?We(t.targetActivityId):qe,i=n&&r(n);if(!i)throw Error(`The target activity is not found.`);let o=typeof e==`function`?e(i.params):e,s=Je();return a()?.actions.stepReplace({stepId:s,stepParams:o,targetActivityId:t?.targetActivityId})},stepPop(e){return a()?.actions.stepPop({targetActivityId:e?.targetActivityId})}}}}var mn=Object.defineProperty,hn=Object.getOwnPropertySymbols,gn=Object.prototype.hasOwnProperty,_n=Object.prototype.propertyIsEnumerable,vn=(e,t,n)=>t in e?mn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yn=(e,t)=>{for(var n in t||={})gn.call(t,n)&&vn(e,n,t[n]);if(hn)for(var n of hn(t))_n.call(t,n)&&vn(e,n,t[n]);return e};function bn(){let[e,t]=(0,C.useReducer)(()=>!0,!1);return(0,C.useEffect)(()=>{t()},[]),e}function W(){return te()}function xn(){let e=W();return yn({},bn()?{"data-stackflow-activity-id":e?.id,"data-stackflow-activity-is-active":e?.isActive,"data-stackflow-activity-transition-state":e?.transitionState}:null)}function Sn(e,t,n){let r=()=>{t.forEach(t=>{e.removeEventListener(t,r)}),n()};t.forEach(t=>{e.addEventListener(t,r)})}var Cn=e=>(e(),window.addEventListener(`resize`,e),()=>{window.removeEventListener(`resize`,e)}),G=()=>{};function wn(e){requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}function Tn({outerRef:e,innerRef:t,enable:n}){let[r,i]=(0,C.useState)(void 0);return(0,C.useEffect)(()=>{let r=e&&`current`in e&&e.current,a=t.current;return!n||!r||!a?G:Cn(()=>{let e=r.clientWidth,t=a.offsetLeft,n=a.clientWidth,o=e-t-n;i(e-2*Math.max(t,o))})}),{maxWidth:r}}function En(e){let[t,n]=(0,C.useState)(void 0);return(0,C.useEffect)(()=>{wn(()=>{n(e)})},[e]),t}function Dn(){return A()}function On({ref:e}){let t=Dn();(0,C.useEffect)(()=>{if(!t)return;let n=e.current;if(!n||t.globalTransitionState===`idle`)return;let r=e=>{e.preventDefault(),e.stopPropagation()};return n.addEventListener(`touchstart`,r,{capture:!0}),n.addEventListener(`touchmove`,r,{capture:!0}),n.addEventListener(`touchend`,r,{capture:!0}),n.addEventListener(`touchcancel`,r,{capture:!0}),()=>{n.removeEventListener(`touchstart`,r,{capture:!0}),n.removeEventListener(`touchmove`,r,{capture:!0}),n.removeEventListener(`touchend`,r,{capture:!0}),n.removeEventListener(`touchcancel`,r,{capture:!0})}},[t?.globalTransitionState])}var kn={};function K({styleName:e,refs:t,effect:n,effectDeps:r}){let i=W();(0,C.useEffect)(()=>i?(kn[e]||(kn[e]=new Map),kn[e].set(i.zIndex,{refs:t,hasEffect:!!n}),()=>{kn[e].delete(i.zIndex)}):G,[i?.id,t,n]),(0,C.useEffect)(()=>{if(!i||!n)return G;let t=(()=>{let t=[];for(let n=1;n<=i.zIndex;n+=1){let r=kn[e].get(i.zIndex-n);if(r?.refs&&(t=[...t,...r.refs]),r?.hasEffect)break}return t})(),r=n({activityTransitionState:i.transitionState,refs:t});return()=>{r?.()}},[i?.transitionState,...r??[]])}function An({refs:e}){K({styleName:`hide`,refs:e,effect:({activityTransitionState:e,refs:t})=>{let n=()=>{t.forEach(e=>{if(!e.current)return;let t=e.current;t.style.display=``})};switch(e){case`enter-done`:return t.forEach(e=>{if(!e.current)return;let t=e.current;t.style.display=`none`}),()=>{n()};default:return n(),G}}})}function jn({refs:e,transitionDuration:t,offsetStyles:n,hasEffect:r=!1}){K({styleName:`offset`,refs:e,effect:r?({activityTransitionState:e,refs:r})=>{let i=()=>{wn(()=>{r.forEach(e=>{if(!e.current)return;let t=e.current;t.style.transform=``,t.style.opacity=``,Sn(t,[`transitionend`,`transitioncancel`],()=>{t.style.transition=``})})})};switch(e){case`enter-active`:case`enter-done`:switch(r.forEach(e=>{e.current&&(e.current.style.transition=t,e.current.style.transform=n.transform,e.current.style.opacity=n.opacity)}),e){case`enter-done`:return()=>{i()};default:return G}case`exit-active`:case`exit-done`:return wn(()=>{i()}),G;default:return G}}:void 0})}var Mn=`--stackflow-swipe-back-ratio`;function Nn({dimRef:e,edgeRef:t,paperRef:n,appBarRef:r,offset:i,transitionDuration:a,preventSwipeBack:o,moveAppBarTogether:s,getActivityTransitionState:c,onSwipeStart:l,onSwipeMove:u,onSwipeEnd:d,onTransitionEnd:f}){K({styleName:`swipe-back`,refs:s&&r?[n,r]:[n],effect:({refs:p})=>{if(o||!e.current||!t.current||!n.current)return G;let m=e.current,h=t.current,g=n.current,_=r?.current,v=null,y=null,b=null,x=[],S=()=>{v=null,y=null,b=null,x=[]},C=!1;function ee({dx:e,ratio:t}){C||(C=!0,requestAnimationFrame(()=>{m.style.opacity=`${1-t}`,m.style.transition=`0s`,g.style.overflowY=`hidden`,g.style.transform=`translate3d(${e}px, 0, 0)`,g.style.transition=`0s`,s&&_&&(_.style.overflowY=`hidden`,_.style.transform=`translate3d(${e}px, 0, 0)`,_.style.transition=`0s`),_?.style.setProperty(Mn,String(t)),p.forEach(e=>{var n;e.current&&(e.current.style.transform=`translate3d(${-1*(1-t)*i}px, 0, 0)`,e.current.style.transition=`0s`,e.current.parentElement?.style.display===`none`&&(e.current.parentElement.style.display=`block`),(n=e.current.parentElement)==null||n.style.setProperty(`--stackflow-swipe-back-ratio`,String(t)))}),C=!1}))}function w({swiped:e}){return new Promise(t=>{requestAnimationFrame(()=>{m.style.opacity=`${e?0:1}`,m.style.transition=a,g.style.overflowY=`hidden`,g.style.transform=`translateX(${e?`100%`:`0`})`,g.style.transition=a,s&&_&&(_.style.overflowY=`hidden`,_.style.transform=`translateX(${e?`100%`:`0`})`,_.style.transition=a),p.forEach(t=>{t.current&&(t.current.style.transition=a,t.current.style.transform=`translate3d(${e?`0`:`-${i/16}rem`}, 0, 0)`)});let n=[...x];t(),Sn(g,[`transitionend`,`transitioncancel`],()=>{let t=e||c()===`exit-active`||c()===`exit-done`;m.style.opacity=``,g.style.overflowY=``,g.style.transform=``,s&&_&&(_.style.overflowY=``,_.style.transform=``,_.style.removeProperty(`transition`)),_?.style.removeProperty(Mn),p.forEach((e,r)=>{var i;if(!e.current)return;let a=n[r];t?(e.current.style.transition=``,e.current.style.transform=``,e.current.parentElement&&(e.current.parentElement.style.display=``)):a&&(e.current.style.transition=a.style.transition,e.current.style.transform=a.style.transform,e.current.parentElement&&a.parentElement&&(e.current.parentElement.style.display=a.parentElement.style.display)),(i=e.current.parentElement)==null||i.style.removeProperty(`--stackflow-swipe-back-ratio`)}),f?.({swiped:e})})})})}let T=e=>{var t;let{activeElement:n}=document;(t=n?.blur)==null||t.call(n),v=b=e.touches[0].clientX,y=Date.now(),x=p.map(e=>e.current?{style:{transform:e.current.style.transform,transition:e.current.style.transition},parentElement:e.current.parentElement?{style:{display:e.current.parentElement.style.display}}:void 0}:{style:{transform:``,transition:``}}),l?.()},E=e=>{if(!v){S();return}b=e.touches[0].clientX;let t=b-v,n=t/g.clientWidth;ee({dx:t,ratio:n}),u?.({dx:t,ratio:n})},D=()=>{if(!v||!y||!b){S();return}let e=Date.now(),t=(b-v)/(e-y)>1||b/g.clientWidth>.4;d?.({swiped:t}),Promise.resolve().then(()=>w({swiped:t})).then(()=>S())};return h.addEventListener(`touchstart`,T,{passive:!0}),h.addEventListener(`touchmove`,E,{passive:!0}),h.addEventListener(`touchend`,D,{passive:!0}),h.addEventListener(`touchcancel`,D,{passive:!0}),()=>{h.removeEventListener(`touchstart`,T),h.removeEventListener(`touchmove`,E),h.removeEventListener(`touchend`,D),h.removeEventListener(`touchcancel`,D)}},effectDeps:[o]})}function Pn(){return(W()?.zIndex??0)*5}var Fn=Object.defineProperty,In=Object.defineProperties,Ln=Object.getOwnPropertyDescriptors,Rn=Object.getOwnPropertySymbols,zn=Object.prototype.hasOwnProperty,Bn=Object.prototype.propertyIsEnumerable,Vn=(e,t,n)=>t in e?Fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,q=(e,t)=>{for(var n in t||={})zn.call(t,n)&&Vn(e,n,t[n]);if(Rn)for(var n of Rn(t))Bn.call(t,n)&&Vn(e,n,t[n]);return e},Hn=(e,t)=>In(e,Ln(t)),Un=e=>(0,T.jsx)(`svg`,{className:e.className,width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`,children:(0,T.jsx)(`path`,{fillRule:`evenodd`,clipRule:`evenodd`,d:`M16.7241 2.76052C17.105 3.16043 17.0896 3.79341 16.6897 4.17431L8.45 12.0222L16.6896 19.8689C17.0896 20.2498 17.105 20.8827 16.7242 21.2827C16.3433 21.6826 15.7103 21.6981 15.3104 21.3172L6.31037 12.7464C6.11218 12.5576 6.00001 12.2959 6 12.0222C5.99999 11.7486 6.11215 11.4868 6.31032 11.2981L15.3103 2.72608C15.7102 2.34518 16.3432 2.3606 16.7241 2.76052Z`,fill:`currentColor`})}),Wn=e=>(0,T.jsx)(`svg`,{className:e.className,width:`24`,height:`24`,viewBox:`0 0 24 24`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`,children:(0,T.jsx)(`path`,{d:`M20.7071 4.70711C21.0976 4.31658 21.0976 3.68342 20.7071 3.29289C20.3166 2.90237 19.6834 2.90237 19.2929 3.29289L12 10.5858L4.70711 3.29289C4.31658 2.90237 3.68342 2.90237 3.29289 3.29289C2.90237 3.68342 2.90237 4.31658 3.29289 4.70711L10.5858 12L3.29289 19.2929C2.90237 19.6834 2.90237 20.3166 3.29289 20.7071C3.68342 21.0976 4.31658 21.0976 4.70711 20.7071L12 13.4142L19.2929 20.7071C19.6834 21.0976 20.3166 21.0976 20.7071 20.7071C21.0976 20.3166 21.0976 19.6834 20.7071 19.2929L13.4142 12L20.7071 4.70711Z`,fill:`currentColor`})}),J={backgroundColor:`var(--stackflow-plugin-basic-ui-background-color)`,backgroundImage:`var(--stackflow-plugin-basic-ui-background-image)`,dimBackgroundColor:`var(--stackflow-plugin-basic-ui-dim-background-color)`,dimHeight:`var(--stackflow-plugin-basic-ui-dim-height)`,transitionDuration:`var(--stackflow-plugin-basic-ui-transition-duration)`,computedTransitionDuration:`var(--stackflow-plugin-basic-ui-computed-transition-duration)`,defaultTransitionOffSet:`var(--stackflow-plugin-basic-ui-default-transition-off-set)`,appBar:{borderColor:`var(--stackflow-plugin-basic-ui-app-bar-border-color)`,borderColorTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-border-color-transition-duration)`,borderSize:`var(--stackflow-plugin-basic-ui-app-bar-border-size)`,height:`var(--stackflow-plugin-basic-ui-app-bar-height)`,heightTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-height-transition-duration)`,minHeight:`var(--stackflow-plugin-basic-ui-app-bar-min-height)`,iconColor:`var(--stackflow-plugin-basic-ui-app-bar-icon-color)`,iconColorTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-icon-color-transition-duration)`,textColor:`var(--stackflow-plugin-basic-ui-app-bar-text-color)`,textColorTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-text-color-transition-duration)`,backgroundColor:`var(--stackflow-plugin-basic-ui-app-bar-background-color)`,backgroundColorTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-background-color-transition-duration)`,backgroundImage:`var(--stackflow-plugin-basic-ui-app-bar-background-image)`,backgroundImageTransitionDuration:`var(--stackflow-plugin-basic-ui-app-bar-background-image-transition-duration)`,overflow:`var(--stackflow-plugin-basic-ui-app-bar-overflow)`,minSafeAreaInsetTop:`var(--stackflow-plugin-basic-ui-app-bar-min-safe-area-inset-top)`,containerPadding:`var(--stackflow-plugin-basic-ui-app-bar-container-padding)`,itemGap:`var(--stackflow-plugin-basic-ui-app-bar-item-gap)`,fontSize:`var(--stackflow-plugin-basic-ui-app-bar-font-size)`,lineHeight:`var(--stackflow-plugin-basic-ui-app-bar-line-height)`,hitSlop:`var(--stackflow-plugin-basic-ui-app-bar-hit-slop)`},bottomSheet:{borderRadius:`var(--stackflow-plugin-basic-ui-bottom-sheet-border-radius)`},modal:{borderRadius:`var(--stackflow-plugin-basic-ui-modal-border-radius)`,maxWidth:`var(--stackflow-plugin-basic-ui-modal-max-width)`},edge:{width:`var(--stackflow-plugin-basic-ui-edge-width)`}},Gn=v({defaultClassName:`_1q6dj2j2`,variantClassNames:{theme:{android:`_1q6dj2j0`,cupertino:`_1q6dj2j1`}},defaultVariants:{},compoundVariants:[]});function Kn(e){return e.filter(e=>e!=null)}function qn(e){return Object.entries(e).reduce((e,[t,n])=>(n!=null&&(e[t]=n),e),{})}var Jn=(0,C.createContext)({theme:`android`}),Yn=Jn.Provider;function Xn(){return(0,C.useContext)(Jn)}var Zn=e=>()=>({key:`basic-ui`,wrapStack({stack:t,initialContext:n}){let r=typeof e==`function`?e({initialContext:n}):e;return(0,T.jsx)(Yn,{value:Hn(q({},r),{theme:n?.theme??r.theme}),children:(0,T.jsx)(`div`,{className:Kn([Gn({theme:n?.theme??r.theme}),r.rootClassName]).join(` `),style:u(qn({[J.backgroundColor]:r.backgroundColor,[J.backgroundImage]:r.backgroundImage,[J.dimBackgroundColor]:r.dimBackgroundColor,[J.dimHeight]:r.dimHeight,[J.transitionDuration]:`${t.transitionDuration}ms`,[J.computedTransitionDuration]:t.globalTransitionState===`loading`?`${t.transitionDuration}ms`:`0ms`,[J.defaultTransitionOffSet]:r.defaultTransitionOffSet,[J.appBar.borderColor]:r.appBar?.borderColor,[J.appBar.borderSize]:r.appBar?.borderSize,[J.appBar.height]:r.appBar?.height,[J.appBar.minHeight]:r.appBar?.minHeight,[J.appBar.iconColor]:r.appBar?.iconColor,[J.appBar.textColor]:r.appBar?.textColor,[J.appBar.minSafeAreaInsetTop]:r.appBar?.minSafeAreaInsetTop,[J.bottomSheet.borderRadius]:r.bottomSheet?.borderRadius,[J.modal.borderRadius]:r.modal?.borderRadius,[J.appBar.containerPadding]:r.appBar?.containerPadding,[J.appBar.fontSize]:r.appBar?.fontSize,[J.appBar.lineHeight]:r.appBar?.lineHeight,[J.appBar.hitSlop]:r.appBar?.hitSlop,[J.appBar.itemGap]:r.appBar?.itemGap,[J.edge.width]:r.edge?.width})),children:t.render()})})}}),Qn=v({defaultClassName:`_1yk3a452 dhthxq4 dhthxq0 dhthxqh _1yk3a451`,variantClassNames:{activityEnterStyle:{slideInLeft:`_1yk3a453`},enterStyle:{cover:`_1yk3a454`},border:{true:`_1yk3a455`},modalPresentationStyle:{fullScreen:`_1yk3a456`}},defaultVariants:{},compoundVariants:[[{activityEnterStyle:`slideInLeft`,enterStyle:`cover`},`_1yk3a457`]]}),$n=`_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi`,er=`dhthxq9 dhthxq7 dhthxq8 _1yk3a450`,tr=`_1yk3a45e`,nr=`_1yk3a45f dhthxqi dhthxq4 dhthxq2 dhthxqf`,rr=`_1yk3a45g dhthxqc dhthxqd dhthxq0`,ir=`_1yk3a45b dhthxq9 dhthxq7 dhthxqb dhthxqf dhthxqi`,ar=`_1yk3a459 dhthxqa dhthxq7 _1yk3a451`,or=`_1yk3a45a dhthxq9 dhthxq7 dhthxq1 _1yk3a450`,sr=`_1yk3a45h dhthxq9 dhthxq7 dhthxq1 dhthxq5 _1yk3a450`,cr=`_1yk3a458`,lr=v({defaultClassName:`dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc`,variantClassNames:{transitionState:{"enter-active":`_1dlf434a`,"enter-done":`_1dlf434b`,"exit-active":`_1dlf434c`,"exit-done":`_1dlf434d`},hasAppBar:{true:`_1dlf434j`}},defaultVariants:{},compoundVariants:[]}),ur=`_1dlf434k dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4347 _1dlf4349`,dr=v({defaultClassName:`_1dlf434r dhthxq4 dhthxq2 dhthxq3 dhthxq1`,variantClassNames:{hasAppBar:{true:`_1dlf434s`}},defaultVariants:{},compoundVariants:[]}),fr=`_1dlf434a`,pr=`_1dlf434b`,mr=`_1dlf434c`,hr=`_1dlf434d`,gr=v({defaultClassName:`_1dlf434l dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 _1dlf4348 _1dlf4349`,variantClassNames:{hasAppBar:{true:`_1dlf434m dhthxqg`},modalPresentationStyle:{fullScreen:`_1dlf434n`},activityEnterStyle:{slideInLeft:`_1dlf434o`}},defaultVariants:{},compoundVariants:[]}),_r=v({defaultClassName:`_1dlf434p dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3`,variantClassNames:{hasAppBar:{true:`_1dlf434q`}},defaultVariants:{},compoundVariants:[]}),vr={transitionDuration:`var(--_1dlf4340)`,zIndexes:{dim:`var(--_1dlf4341)`,paper:`var(--_1dlf4342)`,edge:`var(--_1dlf4343)`,appBar:`var(--_1dlf4344)`},appBar:{topMargin:`var(--_1dlf4345)`,center:{mainWidth:`var(--_1dlf4346)`}}},yr=(0,C.forwardRef)(({title:e,renderLeft:t,renderRight:n,backButton:r,closeButton:i,closeButtonLocation:a=`left`,border:s=!0,modalPresentationStyle:c,activityEnterStyle:l,iconColor:d,iconColorTransitionDuration:f,textColor:p,textColorTransitionDuration:m,borderColor:h,borderColorTransitionDuration:g,borderSize:_,height:v,heightTransitionDuration:y,overflow:b,backgroundColor:x,backgroundColorTransitionDuration:S,backgroundImage:ee,backgroundImageTransitionDuration:w,onTopClick:E,enterStyle:D,className:te,minHeight:O,fontSize:k,lineHeight:A,hitSlop:ne,containerPadding:re,itemGap:ie},ae)=>{let oe=en(),j=W(),se=xn();bn();let M=Xn(),N=M.appBar?.closeButton,P=M.appBar?.backButton,F=(0,C.useRef)(null),{maxWidth:ce}=Tn({outerRef:ae,innerRef:F,enable:M.theme===`cupertino`}),le=(M.theme===`cupertino`&&c!==`fullScreen`||l===`slideInLeft`)&&D!==`cover`,ue=e=>{r&&`onClick`in r&&r.onClick&&r.onClick(e),e.defaultPrevented||oe.pop()},de=()=>!j||j.isRoot?null:!r&&!P?(0,T.jsx)(`button`,{type:`button`,"aria-label":`Go Back`,className:$n,onClick:ue,children:(0,T.jsx)(Un,{})}):r&&`render`in r&&r.render?r.render?.call(r):P&&`render`in P&&P.render?P.render?.call(P):(0,T.jsx)(`button`,{type:`button`,className:$n,"aria-label":r&&`ariaLabel`in r?r.ariaLabel:P&&`ariaLabel`in P?P.ariaLabel:void 0,onClick:ue,children:(()=>r&&`renderIcon`in r&&r.renderIcon?r.renderIcon():P&&`renderIcon`in P&&P.renderIcon?P.renderIcon():c===`fullScreen`?(0,T.jsx)(Wn,{}):(0,T.jsx)(Un,{}))()}),fe=e=>{var t;i&&`onClick`in i&&i.onClick&&i.onClick(e),!e.defaultPrevented&&N&&`onClick`in N&&((t=N.onClick)==null||t.call(N,e))},pe=()=>{let e=!j||j.isRoot,t=e=>e&&`render`in e&&e.render||e&&`renderIcon`in e&&e.renderIcon||e&&`onClick`in e&&e.onClick;return!(t(i)||t(M.appBar?.closeButton))||!e?null:i&&`render`in i&&i.render?i.render():N&&`render`in N&&N.render?N.render():(0,T.jsx)(`button`,{type:`button`,className:ir,"aria-label":i&&`ariaLabel`in i?i.ariaLabel:N&&`ariaLabel`in N?N.ariaLabel:void 0,onClick:fe,children:(()=>i&&`renderIcon`in i&&i.renderIcon?i.renderIcon():N&&`renderIcon`in N&&N.renderIcon?N.renderIcon():(0,T.jsx)(Wn,{}))()})};return(0,T.jsxs)(`div`,Hn(q({ref:ae,className:o(Qn({border:s,modalPresentationStyle:c,activityEnterStyle:l,enterStyle:D}),te),style:u(qn({[J.appBar.iconColor]:d,[J.appBar.iconColorTransitionDuration]:f,[J.appBar.textColor]:p,[J.appBar.textColorTransitionDuration]:m,[J.appBar.borderColor]:h,[J.appBar.borderColorTransitionDuration]:g,[J.appBar.borderSize]:_,[J.appBar.height]:v,[J.appBar.heightTransitionDuration]:y,[J.appBar.overflow]:b,[J.appBar.backgroundColor]:x??(le?J.backgroundColor:`transparent`),[J.appBar.backgroundColorTransitionDuration]:S,[J.appBar.backgroundImage]:ee??(le?J.appBar.backgroundImage:`none`),[J.appBar.backgroundImageTransitionDuration]:w,[vr.appBar.center.mainWidth]:`${ce}px`,[J.appBar.minHeight]:O,[J.appBar.containerPadding]:re,[J.appBar.fontSize]:k,[J.appBar.hitSlop]:ne,[J.appBar.lineHeight]:A,[J.appBar.itemGap]:ie})),"data-part":`appBar`},se),{children:[(0,T.jsx)(`div`,{className:cr}),(0,T.jsxs)(`div`,{className:ar,children:[(0,T.jsxs)(`div`,{className:or,children:[a===`left`&&pe(),de(),t?.()]}),(0,T.jsx)(`div`,{ref:F,className:er,children:(0,T.jsxs)(`div`,{className:tr,children:[typeof e==`string`?(0,T.jsx)(`div`,{className:rr,children:e}):e,(0,T.jsx)(`button`,{className:nr,type:`button`,onClick:E})]})}),(0,T.jsxs)(`div`,{className:sr,children:[n?.(),a===`right`&&pe()]})]})]}))});yr.displayName=`AppBar`;var br=yr,xr=32,Sr=80,Cr=(0,C.createContext)(null),wr=({backgroundColor:e,backgroundImage:t,dimBackgroundColor:n,appBar:r,preventSwipeBack:i,CUPERTINO_ONLY_modalPresentationStyle:a,ANDROID_ONLY_activityEnterStyle:s,className:c,children:l})=>{let d=Xn(),f=W(),p=xn();bn();let{pop:m}=en(),h=(0,C.useRef)(null),g=(0,C.useRef)(null),_=(0,C.useRef)(null),v=(0,C.useRef)(null),y=(0,C.useRef)(null),b=(0,C.useRef)(null),x=d.theme===`cupertino`?a:void 0,S=d.theme===`android`?s:void 0,ee=i||x===`fullScreen`,w=!!r,E=Pn(),D,te,O,k;switch(d.theme){case`cupertino`:D=E+(x===`fullScreen`?2:0),te=E+(w&&x!==`fullScreen`?r.enterStyle===`cover`?2:1:3),O=E+4,k=E+7;break;default:D=E,te=E+(S===`slideInLeft`&&r?.enterStyle!==`cover`?0:2),O=E+4,k=E+(S===`slideInLeft`?6:4);break}let A=f?.transitionState??`enter-done`,ne=En(A);An({refs:[h]}),jn({refs:(d.theme===`cupertino`||S===`slideInLeft`)&&r?.enterStyle!==`cover`?[_]:[_,y],offsetStyles:d.theme===`cupertino`?{transform:`translate3d(-${Sr/16}rem, 0, 0)`,opacity:`1`}:S===`slideInLeft`?{transform:`translate3d(-50%, 0, 0)`,opacity:`0`}:{transform:`translate3d(0, -${xr/16}rem, 0)`,opacity:`1`},transitionDuration:J.computedTransitionDuration,hasEffect:x!==`fullScreen`}),Nn({dimRef:g,edgeRef:v,paperRef:_,appBarRef:y,offset:Sr,transitionDuration:J.transitionDuration,moveAppBarTogether:r?.enterStyle===`cover`,preventSwipeBack:ee||d.theme!==`cupertino`,getActivityTransitionState(){let e=_.current?.parentElement;return e?e.classList.contains(fr)?`enter-active`:e.classList.contains(pr)?`enter-done`:e.classList.contains(mr)?`exit-active`:e.classList.contains(hr)?`exit-done`:null:null},onSwipeEnd({swiped:e}){e&&m()}});let re=e=>{var t,n;(t=r?.onTopClick)==null||t.call(r,e),e.defaultPrevented||(n=b.current)==null||n.scroll({top:0,behavior:`smooth`})};return On({ref:h}),(0,T.jsx)(Cr.Provider,{value:(0,C.useMemo)(()=>({scroll({top:e}){var t;(t=b?.current)==null||t.scroll({top:e,behavior:`smooth`})},zIndices:{dim:D,paper:te,edge:O,appBar:k}}),[b,D,te,O,k]),children:(0,T.jsxs)(`div`,Hn(q({ref:h,className:o(lr({hasAppBar:w,transitionState:A===`enter-done`||A===`exit-done`?A:ne}),c),style:u(qn({[J.backgroundColor]:e,[J.backgroundImage]:t,[J.dimBackgroundColor]:n,[J.appBar.height]:r?.height,[J.appBar.heightTransitionDuration]:r?.heightTransitionDuration,[vr.zIndexes.dim]:`${D}`,[vr.zIndexes.paper]:`${te}`,[vr.zIndexes.edge]:`${O}`,[vr.zIndexes.appBar]:`${k}`,[vr.transitionDuration]:A===`enter-active`||A===`exit-active`?J.computedTransitionDuration:`0ms`})),"data-stackflow-component-name":`AppScreen`},p),{children:[S!==`slideInLeft`&&(0,T.jsx)(`div`,q({ref:g,className:ur,"data-part":`dim`},p)),r&&(0,T.jsx)(br,Hn(q({},r),{ref:y,modalPresentationStyle:x,activityEnterStyle:S,onTopClick:re})),(0,T.jsx)(`div`,Hn(q({ref:_,className:gr({hasAppBar:w,modalPresentationStyle:x,activityEnterStyle:S}),"data-part":`paper`},p),{children:(0,T.jsx)(`div`,{ref:b,className:_r({hasAppBar:w}),children:l})}),f?.id),!f?.isRoot&&d.theme===`cupertino`&&!ee&&(0,T.jsx)(`div`,q({ref:v,className:dr({hasAppBar:w}),"data-part":`edge`},p))]}))})},Tr=v({defaultClassName:`dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc`,variantClassNames:{transitionState:{"enter-active":`_1ht38h04`,"enter-done":`_1ht38h05`,"exit-active":`_1ht38h06`,"exit-done":`_1ht38h07`}},defaultVariants:{},compoundVariants:[]}),Er=`_1ht38h0d dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxqa dhthxq7 _1ht38h03`,Dr=`_1ht38h0e dhthxqc _1ht38h03`,Or={transitionDuration:`var(--_1ht38h00)`,zIndexes:{dim:`var(--_1ht38h01)`,paper:`var(--_1ht38h02)`}},kr=({borderRadius:e=`1rem`,backgroundColor:t,backgroundImage:n,dimBackgroundColor:r,paperRef:i,onOutsideClick:a,children:s,className:c})=>{let l=W(),{pop:d}=en(),f=(0,C.useRef)(null),p=(0,C.useRef)(null);K({styleName:`hide`,refs:[f]}),K({styleName:`offset`,refs:[p]}),K({styleName:`swipe-back`,refs:[p]});let m=(0,C.useRef)(!1),h=e=>{a?.(e),!e.defaultPrevented&&(m.current||(m.current=!0,d()))},g=e=>{e.stopPropagation()},_=Pn()+3,v=Pn()+4,y=l?.transitionState??`enter-done`;return On({ref:f}),(0,T.jsx)(`div`,{className:o(Tr({transitionState:En(y)}),c),ref:f,style:u(qn({[J.bottomSheet.borderRadius]:e,[J.backgroundColor]:t,[J.backgroundImage]:n,[J.dimBackgroundColor]:r,[Or.zIndexes.dim]:`${_}`,[Or.zIndexes.paper]:`${v}`,[Or.transitionDuration]:y===`enter-active`||y===`exit-active`?J.computedTransitionDuration:`0ms`})),"data-stackflow-component-name":`BottomSheet`,"data-stackflow-activity-id":l?.id,"data-stackflow-activity-is-active":l?.isActive,children:(0,T.jsx)(`div`,{className:Er,ref:p,onClick:h,children:(0,T.jsx)(`div`,{className:Dr,ref:i,onClick:g,children:s})})})};kr.displayName=`BottomSheet`;var Ar=v({defaultClassName:`dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc`,variantClassNames:{transitionState:{"enter-active":`_5ozg8c4`,"enter-done":`_5ozg8c5`,"exit-active":`_5ozg8c6`,"exit-done":`_5ozg8c7`}},defaultVariants:{},compoundVariants:[]}),jr=`_5ozg8cd dhthxq4 dhthxq0 dhthxq1 dhthxq2 dhthxq3 dhthxqc dhthxq9 dhthxq7 dhthxqb _5ozg8c3`,Mr=`_5ozg8ce dhthxqc _5ozg8c3`,Nr={transitionDuration:`var(--_5ozg8c0)`,zIndexes:{dim:`var(--_5ozg8c1)`,paper:`var(--_5ozg8c2)`}},Pr=({backgroundColor:e,backgroundImage:t,dimBackgroundColor:n,borderRadius:r=`1rem`,maxWidth:i,onOutsideClick:a,children:s,className:c})=>{let l=W(),{pop:d}=en(),f=(0,C.useRef)(null),p=(0,C.useRef)(null);K({styleName:`hide`,refs:[f]}),K({styleName:`offset`,refs:[p]}),K({styleName:`swipe-back`,refs:[p]});let m=(0,C.useRef)(!1),h=e=>{a?.(e),!e.defaultPrevented&&(m.current||(m.current=!0,d()))},g=e=>{e.stopPropagation()},_=Pn()+3,v=Pn()+4,y=l?.transitionState??`enter-done`;return On({ref:f}),(0,T.jsx)(`div`,{className:o(Ar({transitionState:En(y)}),c),ref:f,style:u(qn({[J.backgroundColor]:e,[J.backgroundImage]:t,[J.dimBackgroundColor]:n,[J.modal.borderRadius]:r,[J.modal.maxWidth]:i,[Nr.zIndexes.dim]:`${_}`,[Nr.zIndexes.paper]:`${v}`,[Nr.transitionDuration]:y===`enter-active`||y===`exit-active`?J.computedTransitionDuration:`0ms`})),"data-stackflow-component-name":`Modal`,"data-stackflow-activity-id":l?.id,"data-stackflow-activity-is-active":l?.isActive,children:(0,T.jsx)(`div`,{className:jr,ref:p,onClick:h,children:(0,T.jsx)(`div`,{className:Mr,onClick:g,children:s})})})};Pr.displayName=`Modal`;function Fr(){return Fr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fr.apply(null,arguments)}var Y;(function(e){e.Pop=`POP`,e.Push=`PUSH`,e.Replace=`REPLACE`})(Y||={});var Ir=function(e){return e},Lr=`beforeunload`,Rr=`popstate`;function zr(e){e===void 0&&(e={});var t=e.window,n=t===void 0?document.defaultView:t,r=n.history;function i(){var e=n.location,t=e.pathname,i=e.search,a=e.hash,o=r.state||{};return[o.idx,Ir({pathname:t,search:i,hash:a,state:o.usr||null,key:o.key||`default`})]}var a=null;function o(){if(a)f.call(a),a=null;else{var e=Y.Pop,t=i(),n=t[0],r=t[1];if(f.length){if(n!=null){var o=l-n;o&&(a={action:e,location:r,retry:function(){b(o*-1)}},b(o))}}else _(e)}}n.addEventListener(Rr,o);var s=Y.Pop,c=i(),l=c[0],u=c[1],d=Ur(),f=Ur();l??(l=0,r.replaceState(Fr({},r.state,{idx:l}),``));function p(e){return typeof e==`string`?e:Gr(e)}function m(e,t){return t===void 0&&(t=null),Ir(Fr({pathname:u.pathname,hash:``,search:``},typeof e==`string`?Kr(e):e,{state:t,key:Wr()}))}function h(e,t){return[{usr:e.state,key:e.key,idx:t},p(e)]}function g(e,t,n){return!f.length||(f.call({action:e,location:t,retry:n}),!1)}function _(e){s=e;var t=i();l=t[0],u=t[1],d.call({action:s,location:u})}function v(e,t){var i=Y.Push,a=m(e,t);function o(){v(e,t)}if(g(i,a,o)){var s=h(a,l+1),c=s[0],u=s[1];try{r.pushState(c,``,u)}catch{n.location.assign(u)}_(i)}}function y(e,t){var n=Y.Replace,i=m(e,t);function a(){y(e,t)}if(g(n,i,a)){var o=h(i,l),s=o[0],c=o[1];r.replaceState(s,``,c),_(n)}}function b(e){r.go(e)}return{get action(){return s},get location(){return u},createHref:p,push:v,replace:y,go:b,back:function(){b(-1)},forward:function(){b(1)},listen:function(e){return d.push(e)},block:function(e){var t=f.push(e);return f.length===1&&n.addEventListener(Lr,Hr),function(){t(),f.length||n.removeEventListener(Lr,Hr)}}}}function Br(e){e===void 0&&(e={});var t=e,n=t.initialEntries,r=n===void 0?[`/`]:n,i=t.initialIndex,a=r.map(function(e){return Ir(Fr({pathname:`/`,search:``,hash:``,state:null,key:Wr()},typeof e==`string`?Kr(e):e))}),o=Vr(i??a.length-1,0,a.length-1),s=Y.Pop,c=a[o],l=Ur(),u=Ur();function d(e){return typeof e==`string`?e:Gr(e)}function f(e,t){return t===void 0&&(t=null),Ir(Fr({pathname:c.pathname,search:``,hash:``},typeof e==`string`?Kr(e):e,{state:t,key:Wr()}))}function p(e,t,n){return!u.length||(u.call({action:e,location:t,retry:n}),!1)}function m(e,t){s=e,c=t,l.call({action:s,location:c})}function h(e,t){var n=Y.Push,r=f(e,t);function i(){h(e,t)}p(n,r,i)&&(o+=1,a.splice(o,a.length,r),m(n,r))}function g(e,t){var n=Y.Replace,r=f(e,t);function i(){g(e,t)}p(n,r,i)&&(a[o]=r,m(n,r))}function _(e){var t=Vr(o+e,0,a.length-1),n=Y.Pop,r=a[t];function i(){_(e)}p(n,r,i)&&(o=t,m(n,r))}return{get index(){return o},get action(){return s},get location(){return c},createHref:d,push:h,replace:g,go:_,back:function(){_(-1)},forward:function(){_(1)},listen:function(e){return l.push(e)},block:function(e){return u.push(e)}}}function Vr(e,t,n){return Math.min(Math.max(e,t),n)}function Hr(e){e.preventDefault(),e.returnValue=``}function Ur(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter(function(e){return e!==t})}},call:function(t){e.forEach(function(e){return e&&e(t)})}}}function Wr(){return Math.random().toString(36).substr(2,8)}function Gr(e){var t=e.pathname,n=t===void 0?`/`:t,r=e.search,i=r===void 0?``:r,a=e.hash,o=a===void 0?``:a;return i&&i!==`?`&&(n+=i.charAt(0)===`?`?i:`?`+i),o&&o!==`#`&&(n+=o.charAt(0)===`#`?o:`#`+o),n}function Kr(e){var t={};if(e){var n=e.indexOf(`#`);n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf(`?`);r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var qr=t(((e,t)=>{var n=[].slice;(function(n,r){return typeof define==`function`&&define.amd!=null?define([],r):e==null?n.UrlPattern=r():t.exports=r()})(e,function(){var e,t,r,i,a,o,s,c,l=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,`\\$&`)},u,d,f,p,m,h;return s=function(e,t){var n,r,i=[];for(n=-1,r=e.length;++n<r;)i=i.concat(t(e[n]));return i},m=function(e,t){var n,r,i=``;for(n=-1,r=e.length;++n<r;)i+=t(e[n]);return i},p=function(e){return RegExp(e.toString()+`|`).exec(``).length-1},d=function(e,t){var n,r,i,a={},o;for(n=-1,i=e.length;++n<i;)r=e[n],o=t[n],o!=null&&(a[r]==null?a[r]=o:(Array.isArray(a[r])||(a[r]=[a[r]]),a[r].push(o)));return a},e={},e.Result=function(e,t){this.value=e,this.rest=t},e.Tagged=function(e,t){this.tag=e,this.value=t},e.tag=function(t,n){return function(r){var i=n(r),a;if(i!=null)return a=new e.Tagged(t,i.value),new e.Result(a,i.rest)}},e.regex=function(t){return function(n){var r=t.exec(n),i;if(r!=null)return i=r[0],new e.Result(i,n.slice(i.length))}},e.sequence=function(){var t=1<=arguments.length?n.call(arguments,0):[];return function(n){var r=-1,i=t.length,a,o,s,c=[];for(o=n;++r<i;){if(a=t[r],s=a(o),s==null)return;c.push(s.value),o=s.rest}return new e.Result(c,o)}},e.pick=function(){var t=arguments[0],r=2<=arguments.length?n.call(arguments,1):[];return function(n){var i,a=e.sequence.apply(e,r)(n);if(a!=null)return i=a.value,a.value=i[t],a}},e.string=function(t){var n=t.length;return function(r){if(r.slice(0,n)===t)return new e.Result(t,r.slice(n))}},e.lazy=function(e){var t=null;return function(n){return t??=e(),t(n)}},e.baseMany=function(t,n,r,i,a){for(var o,s,c=a,l=r?``:[];!(n!=null&&(o=n(c),o!=null)||(s=t(c),s==null));)r?l+=s.value:l.push(s.value),c=s.rest;if(!(i&&l.length===0))return new e.Result(l,c)},e.many1=function(t){return function(n){return e.baseMany(t,null,!1,!0,n)}},e.concatMany1Till=function(t,n){return function(r){return e.baseMany(t,n,!0,!0,r)}},e.firstChoice=function(){var e=1<=arguments.length?n.call(arguments,0):[];return function(t){for(var n=-1,r=e.length,i,a;++n<r;)if(i=e[n],a=i(t),a!=null)return a}},f=function(t){var n={};return n.wildcard=e.tag(`wildcard`,e.string(t.wildcardChar)),n.optional=e.tag(`optional`,e.pick(1,e.string(t.optionalSegmentStartChar),e.lazy(function(){return n.pattern}),e.string(t.optionalSegmentEndChar))),n.name=e.regex(RegExp(`^[`+t.segmentNameCharset+`]+`)),n.named=e.tag(`named`,e.pick(1,e.string(t.segmentNameStartChar),e.lazy(function(){return n.name}))),n.escapedChar=e.pick(1,e.string(t.escapeChar),e.regex(/^./)),n.static=e.tag(`static`,e.concatMany1Till(e.firstChoice(e.lazy(function(){return n.escapedChar}),e.regex(/^./)),e.firstChoice(e.string(t.segmentNameStartChar),e.string(t.optionalSegmentStartChar),e.string(t.optionalSegmentEndChar),n.wildcard))),n.token=e.lazy(function(){return e.firstChoice(n.wildcard,n.optional,n.named,n.static)}),n.pattern=e.many1(e.lazy(function(){return n.token})),n},c={escapeChar:`\\`,segmentNameStartChar:`:`,segmentValueCharset:`a-zA-Z0-9-_~ %`,segmentNameCharset:`a-zA-Z0-9`,optionalSegmentStartChar:`(`,optionalSegmentEndChar:`)`,wildcardChar:`*`},o=function(e,t){if(Array.isArray(e))return m(e,function(e){return o(e,t)});switch(e.tag){case`wildcard`:return`(.*?)`;case`named`:return`([`+t+`]+)`;case`static`:return l(e.value);case`optional`:return`(?:`+o(e.value,t)+`)?`}},a=function(e,t){return t??=c.segmentValueCharset,`^`+o(e,t)+`$`},i=function(e){if(Array.isArray(e))return s(e,i);switch(e.tag){case`wildcard`:return[`_`];case`named`:return[e.value];case`static`:return[];case`optional`:return i(e.value)}},u=function(e,t,n,r){var i,a,o,s;if(r??=!1,s=e[t],s==null){if(r)throw Error("no values provided for key `"+t+"`");return}if(i=n[t]||0,a=Array.isArray(s)?s.length-1:0,i>a){if(r)throw Error("too few values provided for key `"+t+"`");return}return o=Array.isArray(s)?s[i]:s,r&&(n[t]=i+1),o},r=function(e,t,n){var i,a;if(Array.isArray(e)){for(i=-1,a=e.length;++i<a;)if(r(e[i],t,n))return!0;return!1}switch(e.tag){case`wildcard`:return u(t,`_`,n,!1)!=null;case`named`:return u(t,e.value,n,!1)!=null;case`static`:return!1;case`optional`:return r(e.value,t,n)}},h=function(e,t,n){if(Array.isArray(e))return m(e,function(e){return h(e,t,n)});switch(e.tag){case`wildcard`:return u(t,`_`,n,!0);case`named`:return u(t,e.value,n,!0);case`static`:return e.value;case`optional`:return r(e.value,t,n)?h(e.value,t,n):``}},t=function(e,n){var r,o,s,l,u;if(e instanceof t){this.isRegex=e.isRegex,this.regex=e.regex,this.ast=e.ast,this.names=e.names;return}if(this.isRegex=e instanceof RegExp,!(typeof e==`string`||this.isRegex))throw TypeError(`argument must be a regex or a string`);if(this.isRegex){if(this.regex=e,n!=null){if(!Array.isArray(n))throw Error(`if first argument is a regex the second argument may be an array of group names but you provided something else`);if(r=p(this.regex),n.length!==r)throw Error(`regex contains `+r+` groups but array of group names contains `+n.length);this.names=n}return}if(e===``)throw Error(`argument must not be the empty string`);if(u=e.replace(/\s+/g,``),u!==e)throw Error(`argument must not contain whitespace`);if(o={escapeChar:n?.escapeChar||c.escapeChar,segmentNameStartChar:n?.segmentNameStartChar||c.segmentNameStartChar,segmentNameCharset:n?.segmentNameCharset||c.segmentNameCharset,segmentValueCharset:n?.segmentValueCharset||c.segmentValueCharset,optionalSegmentStartChar:n?.optionalSegmentStartChar||c.optionalSegmentStartChar,optionalSegmentEndChar:n?.optionalSegmentEndChar||c.optionalSegmentEndChar,wildcardChar:n?.wildcardChar||c.wildcardChar},l=f(o),s=l.pattern(e),s==null)throw Error(`couldn't parse pattern`);if(s.rest!==``)throw Error(`could only partially parse pattern`);this.ast=s.value,this.regex=new RegExp(a(this.ast,o.segmentValueCharset)),this.names=i(this.ast)},t.prototype.match=function(e){var t,n=this.regex.exec(e);return n==null?null:(t=n.slice(1),this.names?d(this.names,t):t)},t.prototype.stringify=function(e){if(e??={},this.isRegex)throw Error(`can't stringify patterns generated from a regex`);if(e!==Object(e))throw Error(`argument must be an object or undefined`);return h(this.ast,e,{})},t.escapeForRegex=l,t.concatMap=s,t.stringConcatMap=m,t.regexGroupCount=p,t.keysAndValuesToObject=d,t.P=e,t.newParser=f,t.defaultOptions=c,t.astNodeToRegexString=a,t.astNodeToNames=i,t.getParam=u,t.astNodeContainsSegmentsForProvidedParams=r,t.stringify=h,t})})),{parse:Jr,stringify:Yr}=JSON,{keys:Xr}=Object,Zr=String,Qr=`string`,$r={},ei=`object`,ti=(e,t)=>t,ni=e=>e instanceof Zr?Zr(e):e,ri=(e,t)=>typeof t===Qr?new Zr(t):t,ii=(e,t,n,r)=>{let i=[];for(let a=Xr(n),{length:o}=a,s=0;s<o;s++){let o=a[s],c=n[o];if(c instanceof Zr){let a=e[c];typeof a===ei&&!t.has(a)?(t.add(a),n[o]=$r,i.push({k:o,a:[e,t,a,r]})):n[o]=r.call(n,o,a)}else n[o]!==$r&&(n[o]=r.call(n,o,c))}for(let{length:e}=i,t=0;t<e;t++){let{k:e,a}=i[t];n[e]=r.call(n,e,ii.apply(null,a))}return n},ai=(e,t,n)=>{let r=Zr(t.push(n)-1);return e.set(n,r),r};const oi=(e,t)=>{let n=Jr(e,ri).map(ni),r=n[0],i=t||ti,a=typeof r===ei&&r?ii(n,new Set,r,i):r;return i.call({"":a},``,a)},si=(e,t,n)=>{let r=t&&typeof t===ei?(e,n)=>e===``||-1<t.indexOf(e)?n:void 0:t||ti,i=new Map,a=[],o=[],s=+ai(i,a,r.call({"":e},``,e)),c=!s;for(;s<a.length;)c=!0,o[s]=Yr(a[s++],l,n);return`[`+o.join(`,`)+`]`;function l(e,t){if(c)return c=!c,t;let n=r.call(this,e,t);switch(typeof n){case ei:if(n===null)return n;case Qr:return i.get(n)||ai(i,a,n)}return n}};var ci=e(qr(),1),li=e(qr(),1),ui=Object.defineProperty,di=Object.defineProperties,fi=Object.getOwnPropertyDescriptors,pi=Object.getOwnPropertySymbols,mi=Object.prototype.hasOwnProperty,hi=Object.prototype.propertyIsEnumerable,gi=(e,t,n)=>t in e?ui(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X=(e,t)=>{for(var n in t||={})mi.call(t,n)&&gi(e,n,t[n]);if(pi)for(var n of pi(t))hi.call(t,n)&&gi(e,n,t[n]);return e},Z=(e,t)=>di(e,fi(t)),Q=(e,t,n)=>gi(e,typeof t==`symbol`?t:t+``,n),_i=(e,t,n)=>new Promise((r,i)=>{var a=e=>{try{s(n.next(e))}catch(e){i(e)}},o=e=>{try{s(n.throw(e))}catch(e){i(e)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((n=n.apply(e,t)).next())}),vi=(0,C.createContext)({requestHistoryTick:()=>{}}),yi=({children:e,requestHistoryTick:t})=>{let n=(0,C.useMemo)(()=>({requestHistoryTick:t}),[t]);return(0,T.jsx)(vi.Provider,{value:n,children:e})},bi=(0,C.createContext)([]);function xi(e){return e.name===`Pushed`||e.name===`Popped`||e.name===`Replaced`}function Si(e){return e.name===`StepPushed`||e.name===`StepPopped`||e.name===`StepReplaced`}function Ci(e){return xi(e)||Si(e)}var wi={IDLE:`idle`,PROGRESS:`progress`,SUCCEEDED:`succeeded`,FAILED:`failed`};function Ti(e){return e===wi.SUCCEEDED||e===wi.FAILED}var Ei=class{constructor(e,t){Q(this,`targetId`),Q(this,`initialSetupProcess`),Q(this,`focusCount`),Q(this,`previousActivationTrigger`),this.targetId=e,this.initialSetupProcess=t,this.focusCount=0,this.previousActivationTrigger=null}captureStackChange(e){if(!Ti(this.initialSetupProcess.getStatus()))return;let t=e.activities.find(e=>e.id===this.targetId);if(!t||!t.isActive)return;let n=e.events.findLast(xi);!n||this.previousActivationTrigger&&n.eventDate<=this.previousActivationTrigger.eventDate||(this.focusCount++,this.previousActivationTrigger=n)}getActivationCount(){return this.focusCount}getTargetId(){return this.targetId}},Di=`@stackflow/plugin-history-sync`;function Oi(e){return{_TAG:Di,flattedState:si({activity:e.activity,step:e.step})}}function ki(e){return typeof e==`object`&&!!e&&`_TAG`in e&&`flattedState`in e&&typeof e._TAG==`string`&&e._TAG===Di&&typeof e.flattedState==`string`}function Ai(e){try{return ki(e)?oi(e.flattedState):null}catch{return null}}function ji({history:e,pathname:t,state:n,useHash:r}){let i=r?`${e.location.pathname}#${t}`:t;e.push(i,Oi(n))}function Mi({history:e,pathname:t,state:n,useHash:r}){let i=r?`${e.location.pathname}#${t}`:t;e.replace(i,Oi(n))}function Ni(e){return e.length===0?void 0:e[e.length-1]}var Pi=e=>{let t=Promise.resolve();return{requestHistoryTick:n=>{t=t.then(()=>new Promise(t=>{let r=e.listen(()=>{r(),t()});n(()=>{r(),t()})}))}}};function Fi(e){return new URL(e,`file://`)}function Ii(e){let t={};return e.forEach((e,n)=>{t[n]=e}),t}function Li(e){return e.endsWith(`/`)?e:`${e}/`}function Ri(e){return e.toString().length>0?`?${e}`:e}function $({path:e,decode:t},n){let r=new li.default(`${e}(/)`,n);return{fill(e){let t=r.stringify(e),n=r.match(t),i=X({},e);Object.keys(n).forEach(e=>{delete i[e]});let a=new URLSearchParams(Object.entries(i).reduce((e,[t,n])=>X(X({},e),n?{[t]:n}:null),{}));return Li(t)+Ri(a)},parse(e){let n=Fi(e),i=r.match(n.pathname),a=Ii(n.searchParams);if(!i)return null;let o=X(X({},a),i);return t?t(o):o},variableCount:e===`*`||e===`/*`?1/0:r.names.length}}var zi=class{constructor(e,t=[]){Q(this,`status`),Q(this,`pendingNavigations`),Q(this,`dispatchedEvents`),Q(this,`baseNavigationEvents`),this.status=e.length>0?wi.IDLE:wi.SUCCEEDED,this.pendingNavigations=e.slice(),this.dispatchedEvents=[],this.baseNavigationEvents=t}captureNavigationOpportunity(e){if(Ti(this.status)||e&&e.globalTransitionState!==`idle`)return[];if(this.pendingNavigations.length===0)return this.status=wi.SUCCEEDED,[];let t=e?e.events.filter(Ci):[];if(!(this.verifyAllDispatchedEventsAreInNavigationHistory(t)&&this.verifyNoUnknownNavigationEvents(t)))return this.pendingNavigations=[],this.status=wi.FAILED,[];let n=this.pendingNavigations.shift();if(!n)return[];let r=n();return this.dispatchedEvents.push(...r),this.status=wi.PROGRESS,r}getStatus(){return this.status}verifyAllDispatchedEventsAreInNavigationHistory(e){let t=new Set(e.map(e=>e.id));return this.dispatchedEvents.every(e=>t.has(e.id))}verifyNoUnknownNavigationEvents(e){let t=new Set([...this.baseNavigationEvents,...this.dispatchedEvents].map(e=>e.id));return e.every(e=>t.has(e.id))}};function Bi(e){return typeof e==`string`?{path:e}:e}function Vi(e){return(Array.isArray(e)?e:[e]).map(Bi)}function Hi(e){return Object.keys(e).flatMap(t=>{let n=e[t];return n?Vi(n).map(e=>X({activityName:t},e)):[]})}var Ui=class{constructor(){Q(this,`latestlyBookedSession`,Promise.resolve())}acquire(){return new Promise(e=>{this.latestlyBookedSession=this.latestlyBookedSession.then(()=>new Promise(t=>e({release:()=>t()})))})}runExclusively(e){return _i(this,null,function*(){let{release:t}=yield this.acquire();try{return yield e()}finally{t()}})}},Wi=class{constructor(){Q(this,`subscribers`,[]),Q(this,`publishLock`,new Ui)}subscribe(e){return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter(t=>t!==e)}}publish(e){let t=this.subscribers.slice();return this.publishLock.runExclusively(()=>Promise.allSettled(t.map(t=>t(e))))}};function Gi(e,t){if(!e)return{entries:[]};let n=e(t);return Array.isArray(n)?{entries:n}:n}var Ki=(0,C.createContext)([]),qi=e=>(0,T.jsx)(Ki.Provider,{value:e.routes,children:e.children});qi.displayName=`RoutesProvider`;var Ji=/^:[\w-]+$/,Yi=3,Xi=1,Zi=10,Qi=-2,$i=e=>e===`*`;function ea(e){let t=e.split(`/`),n=t.length;return t.some($i)&&(n+=Qi),t.filter(e=>!$i(e)).reduce((e,t)=>e+(Ji.test(t)?Yi:t===``?Xi:Zi),n)}function ta(e){return[...e].sort((e,t)=>ea(t.path)-ea(e.path))}function na(e){`config`in e&&e.config.decorate(`historySync`,{makeTemplate:$,urlPatternOptions:e.urlPatternOptions});let t=e.history??(typeof window>`u`?Br({}):zr({window})),{location:n}=t,r=ta(Hi(`routes`in e?e.routes:e.config.activities.reduce((e,t)=>Z(X({},e),{[t.name]:t.route}),{})));return()=>{let i=0,a=!1,o=null,s=[],c=new Wi,{requestHistoryTick:l}=Pi(t),u=e=>c.subscribe(()=>_i(this,null,function*(){return e()})),d=null,f=()=>{let e=s.map(e=>({activityId:e.getTargetId(),activationCount:e.getActivationCount()}));return(!d||d.length!==e.length||d.some(({activityId:t,activationCount:n})=>e.some(({activityId:e,activationCount:r})=>e===t&&r!==n)))&&(d=e),d},p=e=>{let t=!1;for(let n of s){let r=n.getActivationCount();n.captureStackChange(e),r!==n.getActivationCount()&&(t=!0)}t&&c.publish()};return{key:`plugin-history-sync`,wrapStack({stack:e}){let t=(0,C.useSyncExternalStore)(u,f,f);return(0,T.jsx)(yi,{requestHistoryTick:l,children:(0,T.jsx)(qi,{routes:r,children:(0,T.jsx)(bi.Provider,{value:t,children:e.render()})})})},overrideInitialEvents({initialContext:i}){let a=Ai(t.location.state);if(a)return[Z(X({},a.activity.enteredBy),{name:`Pushed`}),...a.step?.enteredBy.name===`StepPushed`||a.step?.enteredBy.name===`StepReplaced`?[Z(X({},a.step.enteredBy),{name:`StepPushed`})]:[]];function c(){return i?.req?.path&&typeof i.req.path==`string`?i.req.path:e.useHash?n.hash.split(`#`)[1]??`/`:n.pathname+n.search}let l=c(),u=e.fallbackActivity({initialContext:i}),d=r.find(t=>$(t,e.urlPatternOptions).parse(l)!==null)??r.find(e=>e.activityName===u),f=new ci.default(`${d.path}(/)`,e.urlPatternOptions),p=Fi(l),m=f.match(p.pathname),h=X(X({},Ii(p.searchParams)),m),g=Gi(d.defaultHistory,h),_=({activityName:e,activityParams:t,additionalSteps:n=[]})=>[{name:`Pushed`,id:I(),activityId:I(),activityName:e,activityParams:X({},t),activityContext:{path:l,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}},...n.map(({stepParams:e,hasZIndex:t})=>({name:`StepPushed`,id:I(),stepId:I(),stepParams:e,hasZIndex:t}))],v=()=>({name:`Pushed`,id:I(),activityId:I(),activityName:d.activityName,activityParams:$(d,e.urlPatternOptions).parse(l)??Ii(Fi(l).searchParams),activityContext:{path:l,lazyActivityComponentRenderContext:{shouldRenderImmediately:!0}}});o=g.skipDefaultHistorySetupTransition?new zi([()=>[...g.entries.flatMap(e=>_(e).map(e=>e.name===`Pushed`?(s.push(new Ei(e.activityId,o)),Z(X({},e),{skipEnterActiveState:!0})):e)),Z(X({},v()),{skipEnterActiveState:!0})]]):new zi([...g.entries.map(e=>()=>_(e).map(e=>e.name===`Pushed`?(s.push(new Ei(e.activityId,o)),X({},e)):e)),()=>[v()]]);let y=Date.now(),b=o.captureNavigationOpportunity(null).map((e,t,n)=>Z(X({},e),{eventDate:y-(n.length-t)})),x=b.find(e=>e.name===`Pushed`);return b.map(e=>e.id===x?.id?Z(X({},e),{skipEnterActiveState:!0}):e)},onInit({actions:{getStack:n,dispatchEvent:s,push:c,stepPush:l}}){let u=n();if(Ai(t.location.state)===null){for(let n of u.activities)if(n.transitionState===`enter-active`||n.transitionState===`enter-done`){let i=$(r.find(e=>e.activityName===n.name),e.urlPatternOptions);n.isRoot?Mi({history:t,pathname:i.fill(n.params),state:{activity:n},useHash:e.useHash}):ji({history:t,pathname:i.fill(n.params),state:{activity:n},useHash:e.useHash});for(let r of n.steps)!r.exitedBy&&r.enteredBy.name!==`Pushed`&&ji({history:t,pathname:i.fill(r.params),state:{activity:n,step:r},useHash:e.useHash})}}t.listen(e=>{if(a){a=!1;return}let t=Ai(e.location.state);if(!t)return;let r=t.activity,o=t.activity.id,u=t.step,{activities:d}=n(),f=d.find(e=>e.isActive);if(!f)return;let p=Ni(f.steps),m=d.find(e=>e.id===o),h=f.steps.find(e=>e.id===u?.id),g=()=>f.id>o,_=()=>f.id<o,v=()=>f.id===o,y=()=>v()?!!(!u||p&&p.id>u.id):!1,b=()=>v()?!!(!p||u&&p.id<u.id):!1;if(g()&&(s(`Popped`,{}),!m&&(i+=1,c(X({},r.enteredBy)),u?.enteredBy.name===`StepPushed`||u?.enteredBy.name===`StepReplaced`))){let{enteredBy:e}=u;i+=1,l(X({},e))}if(y()){if(!h&&u&&(u?.enteredBy.name===`StepPushed`||u?.enteredBy.name===`StepReplaced`)){let{enteredBy:e}=u;i+=1,l(X({},e))}s(`StepPopped`,{})}if(_()&&(i+=1,c({activityId:r.id,activityName:r.name,activityParams:r.params})),b()){if(!u)return;i+=1,l({stepId:u.id,stepParams:u.params})}}),o?.captureNavigationOpportunity(u).forEach(e=>e.name===`Pushed`?c(e):l(e)),p(u)},onPushed({effect:{activity:n}}){if(i){--i;return}let o=$(r.find(e=>e.activityName===n.name),e.urlPatternOptions);l(()=>{a=!0,ji({history:t,pathname:o.fill(n.params),state:{activity:n},useHash:e.useHash})})},onStepPushed({effect:{activity:n,step:o}}){if(i){--i;return}let s=$(r.find(e=>e.activityName===n.name),e.urlPatternOptions);l(()=>{a=!0,ji({history:t,pathname:s.fill(n.params),state:{activity:n,step:o},useHash:e.useHash})})},onReplaced({effect:{activity:n}}){if(!n.isActive)return;let i=$(r.find(e=>e.activityName===n.name),e.urlPatternOptions);l(()=>{a=!0,Mi({history:t,pathname:i.fill(n.params),state:{activity:n},useHash:e.useHash})})},onStepReplaced({effect:{activity:n,step:i}}){if(!n.isActive)return;let o=$(r.find(e=>e.activityName===n.name),e.urlPatternOptions);l(()=>{a=!0,Mi({history:t,pathname:o.fill(n.params),state:{activity:n,step:i},useHash:e.useHash})})},onBeforePush({actionParams:t,actions:{overrideActionParams:n}}){if(!t.activityContext||!(`path`in t.activityContext)){let i=$(r.find(e=>e.activityName===t.activityName),e.urlPatternOptions).fill(t.activityParams);n(Z(X({},t),{activityContext:Z(X({},t.activityContext),{path:i})}))}},onBeforeReplace({actionParams:n,actions:{overrideActionParams:i,getStack:o}}){if(!n.activityContext||!(`path`in n.activityContext)){let t=$(r.find(e=>e.activityName===n.activityName),e.urlPatternOptions).fill(n.activityParams);i(Z(X({},n),{activityContext:Z(X({},n.activityContext),{path:t})}))}let{activities:s}=o(),c=s.filter(e=>e.transitionState===`enter-active`||e.transitionState===`enter-done`),u=c.length>0?c[c.length-1]:null;if(u)for(let e=0;e<u.steps.length-1;e+=1)l(e=>{Ai(t.location.state)?e():(a=!0,t.back())}),l(()=>{a=!0,t.back()})},onBeforeStepPop({actions:{getStack:e}}){let{activities:n}=e();(n.find(e=>e.isActive)?.steps.length??0)>1&&l(()=>{a=!0,t.back()})},onBeforePop({actions:{getStack:e}}){let{activities:n}=e(),r=n.find(e=>e.isActive);if(r){let{isRoot:e,steps:n}=r,i=e?0:n.length;for(let e=0;e<i;e+=1)l(e=>{Ai(t.location.state)?e():(a=!0,t.back())}),l(()=>{a=!0,t.back()})}},onChanged({actions:{getStack:e,push:t,stepPush:n}}){let r=e();o?.captureNavigationOpportunity(r).forEach(e=>e.name===`Pushed`?t(e):n(e)),p(r)}}}}function ra(){return()=>({key:`plugin-renderer-basic`,render({stack:e}){return(0,T.jsx)(T.Fragment,{children:e.render().activities.filter(e=>e.transitionState!==`exit-done`).map(e=>(0,T.jsx)(C.Fragment,{children:e.render()},e.key))})}})}function ia(){return()=>({key:`plugin-renderer-web`,render({stack:e}){return(0,T.jsx)(T.Fragment,{children:e.render().activities.filter(e=>e.isActive).map(e=>(0,T.jsx)(C.Fragment,{children:e.render()},e.key))})}})}var aa=(0,C.createContext)(null),oa=({children:e,value:t})=>(0,T.jsx)(aa.Provider,{value:t,children:e});oa.displayName=`ConfigProvider`,(0,C.createContext)(null);var sa=Object.defineProperty,ca=Object.getOwnPropertySymbols,la=Object.prototype.hasOwnProperty,ua=Object.prototype.propertyIsEnumerable,da=(e,t,n)=>t in e?sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fa=(e,t)=>{for(var n in t||={})la.call(t,n)&&da(e,n,t[n]);if(ca)for(var n of ca(t))ua.call(t,n)&&da(e,n,t[n]);return e};function pa(e){return!e||e.animate==null?{skipActiveState:!1}:{skipActiveState:!e.animate}}function ma(e){return{push(t,n,r){var i;let a=V();return(i=e())==null||i.push({activityId:a,activityName:t,activityParams:n,skipEnterActiveState:pa(r).skipActiveState}),{activityId:a}},replace(t,n,r){var i;let a=r?.activityId??V();return(i=e())==null||i.replace({activityId:a,activityName:t,activityParams:n,skipEnterActiveState:pa(r).skipActiveState}),{activityId:a}},pop(t,n){var r;let i=1,a={};typeof t==`object`&&(a=fa({},t)),typeof t==`number`&&(i=t),n&&(a=fa({},n));for(let t=0;t<i;t+=1)(r=e())==null||r.pop({skipExitActiveState:t===0?pa(a).skipActiveState:!0})}}}function ha(){let e=tt();return ma(()=>e)}export{Br as a,pn as c,o as d,na as i,en as l,ia as n,wr as o,ra as r,Zn as s,ha as t,a as u};