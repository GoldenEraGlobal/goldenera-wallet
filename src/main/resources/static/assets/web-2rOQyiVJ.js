import{C as e,S as t,x as n}from"./vendor-capacitor-BX7UtLP6.js";import{n as r,t as i}from"./index-Beq4vKYE.js";var a=class extends e{constructor(){super(...arguments),this._isSupported=`BarcodeDetector`in window,this.errorVideoElementMissing=`videoElement must be provided.`,this.eventBarcodesScanned=`barcodesScanned`}async startScan(e){if(!this._isSupported)throw this.createUnimplementedException();if(!e?.videoElement)throw Error(this.errorVideoElementMissing);this.videoElement=e.videoElement,this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:e?.lensFacing===r.Front?`user`:`environment`}},audio:!1}),e.videoElement.srcObject=this.stream,await e.videoElement.play();let t=new BarcodeDetector;this.intervalId=window.setInterval(async()=>{if(!e.videoElement)return;let n=await t.detect(e.videoElement);n.length!==0&&this.handleScannedBarcodes(n)},500)}async stopScan(){if(!this._isSupported)throw this.createUnimplementedException();this.intervalId&&=(clearInterval(this.intervalId),void 0),this.stream&&=(this.stream.getTracks().forEach(e=>e.stop()),void 0),this.videoElement&&=(this.videoElement.srcObject=null,void 0)}async readBarcodesFromImage(e){throw this.createUnimplementedException()}async scan(){throw this.createUnimplementedException()}async isSupported(){return{supported:this._isSupported}}async enableTorch(){throw this.createUnimplementedException()}async disableTorch(){throw this.createUnimplementedException()}async toggleTorch(){throw this.createUnimplementedException()}async isTorchEnabled(){throw this.createUnimplementedException()}async isTorchAvailable(){return{available:!1}}async setZoomRatio(e){throw this.createUnimplementedException()}async getZoomRatio(){throw this.createUnimplementedException()}async getMinZoomRatio(){throw this.createUnimplementedException()}async getMaxZoomRatio(){throw this.createUnimplementedException()}async openSettings(){throw this.createUnimplementedException()}async isGoogleBarcodeScannerModuleAvailable(){throw this.createUnimplementedException()}async installGoogleBarcodeScannerModule(){throw this.createUnimplementedException()}async checkPermissions(){try{return{camera:(await navigator.permissions.query({name:`camera`})).state}}catch{return{camera:`prompt`}}}async requestPermissions(){try{return(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>e.stop()),{camera:`granted`}}catch{return{camera:`denied`}}}createUnimplementedException(){return new n(`This method is not implemented on web.`,t.Unimplemented)}handleScannedBarcodes(e){let t={barcodes:e.map(e=>({cornerPoints:[[e.cornerPoints[0].x,e.cornerPoints[0].y],[e.cornerPoints[1].x,e.cornerPoints[1].y],[e.cornerPoints[2].x,e.cornerPoints[2].y],[e.cornerPoints[3].x,e.cornerPoints[3].y]],displayValue:e.rawValue,rawValue:e.rawValue,format:e.format.toUpperCase(),valueType:i.Unknown}))};this.notifyListeners(this.eventBarcodesScanned,t)}};export{a as BarcodeScannerWeb};